<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>¬© ùó¢ùó°ùóòùóòùó´ùóß ùóüùóßùóóùóî</title>
  <meta name="description" content="¬© neext ltda." />
  
  <!-- √çcone da p√°gina -->
  <link rel="icon" href="https://i.imgur.com/nTqoKxv.png" type="image/x-icon">
  
  <!-- Google Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">

  <!-- Open Graph tags -->
  <meta property="og:title" content="¬© ùó¢ùó°ùóòùóòùó´ùóß ùóüùóßùóóùóî" />
  <meta property="og:description" content="¬© neext ltda." />
  <meta property="og:type" content="website" />

  <!-- Three.js for background animation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js"></script>
  
  <!-- Lucide Icons (SVG based) -->
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      border-color: hsl(214.3 31.8% 91.4%);
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      overflow-x: hidden;
      background-color: #0f172a;
      color: white;
    }

    .atom-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .login-container {
      display: flex;
      width: 90%;
      max-width: 1000px;
      min-height: 600px;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 10;
      backdrop-filter: blur(12px);
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .image-side {
      flex: 1;
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.8) 0%, rgba(217, 70, 239, 0.8) 100%);
      display: none;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(8px);
      border-right: 1px solid rgba(255, 255, 255, 0.2);
    }

    .image-side::before {
      content: '';
      position: absolute;
      width: 140%;
      height: 140%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
      top: -20%;
      left: -20%;
    }

    .brand-logo {
      position: relative;
      z-index: 2;
      color: white;
      font-size: 28px;
      font-weight: 700;
      text-align: center;
    }

    .brand-logo img {
      max-width: 120px;
      margin-bottom: 16px;
      animation: float 6s ease-in-out infinite;
    }

    .brand-logo .tagline {
      font-size: 16px;
      font-weight: 500;
      opacity: 0.8;
      margin-top: 8px;
    }

    .form-side {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      padding: 48px 40px;
      display: flex;
      flex-direction: column;
      backdrop-filter: blur(14px);
      position: relative;
      z-index: 1;
    }

    .form-header {
      margin-bottom: 32px;
    }

    .form-header h2 {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 8px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .form-header p {
      color: rgba(255, 255, 255, 0.8);
      font-size: 15px;
    }

    .input-group {
      position: relative;
      margin-bottom: 24px;
    }

    .label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 600;
      color: rgba(255, 255, 255, 0.9);
    }

    .input-container {
      position: relative;
    }

    .input-group input,
    .input-group select {
      width: 100%;
      padding: 12px 16px;
      padding-left: 40px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.2s ease;
      background-color: rgba(255, 255, 255, 0.1);
      color: #ffffff;
    }

    .input-group select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23ffffff' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.75rem center;
      background-repeat: no-repeat;
      background-size: 16px 12px;
      padding-right: 2.5rem;
    }

    .input-group input:focus,
    .input-group select:focus {
      border-color: #8b5cf6;
      outline: none;
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
      background-color: rgba(255, 255, 255, 0.15);
    }

    .input-group input::placeholder,
    .input-group select::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .input-icon {
      position: absolute;
      top: 50%;
      left: 14px;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.7);
    }

    .password-toggle {
      position: absolute;
      top: 50%;
      right: 14px;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      background: none;
      border: none;
      padding: 4px;
      transition: color 0.2s ease;
    }

    .password-toggle:hover {
      color: rgba(255, 255, 255, 0.9);
    }

    .remember-me {
      display: flex;
      align-items: center;
      margin-bottom: 24px;
      font-size: 14px;
    }

    .remember-me input {
      margin-right: 8px;
      width: 16px;
      height: 16px;
      accent-color: #8b5cf6;
    }

    .remember-me label {
      color: rgba(255, 255, 255, 0.8);
      font-weight: 500;
    }

    .login-button {
      width: 100%;
      padding: 12px;
      background: #8b5cf6;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .login-button:hover {
      background: #7c3aed;
      transform: translateY(-2px);
    }

    .login-button:active {
      transform: translateY(1px);
    }

    .premium-badge {
      position: absolute;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #f97316 0%, #db2777 100%);
      color: white;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.5px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      z-index: 50;
      backdrop-filter: blur(4px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      animation: float 6s ease-in-out infinite;
    }

    .social-buttons {
      display: flex;
      justify-content: center;
      margin-top: 24px;
      gap: 16px;
    }

    .social-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      transition: all 0.2s ease;
      color: white;
    }

    .instagram-button {
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
    }

    .whatsapp-button {
      background: #25D366;
    }

    .social-button:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
    }

    .form-footer {
      margin-top: auto;
      text-align: center;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.6);
      padding-top: 24px;
    }

    .loader-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(8px);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .loader-container.active {
      opacity: 1;
      pointer-events: all;
    }

    .loader {
      position: relative;
      width: 80px;
      height: 80px;
    }

    .loader div:nth-child(1) {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 4px solid transparent;
      border-top-color: #8b5cf6;
      border-radius: 50%;
      animation: spin 1.5s linear infinite;
    }

    .loader div:nth-child(2) {
      position: absolute;
      width: 100%;
      height: 100%;
      border: 4px solid transparent;
      border-right-color: #db2777;
      border-radius: 50%;
      animation: spin 1.2s linear infinite reverse;
    }

    .loader div:nth-child(3) {
      position: absolute;
      width: 12px;
      height: 12px;
      background: white;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: pulse 2s ease infinite;
    }

    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 20px;
      border-radius: 8px;
      color: white;
      font-size: 14px;
      max-width: 320px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      gap: 12px;
      transform: translateY(-20px);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
      backdrop-filter: blur(4px);
    }

    .toast.success {
      background-color: rgba(16, 185, 129, 0.9);
      border-left: 4px solid #10b981;
    }

    .toast.error {
      background-color: rgba(239, 68, 68, 0.9);
      border-left: 4px solid #ef4444;
    }

    .toast.warning {
      background-color: rgba(245, 158, 11, 0.9);
      border-left: 4px solid #f59e0b;
    }

    .toast.show {
      transform: translateY(0);
      opacity: 1;
    }

    @keyframes float {
      0% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-10px);
      }
      100% {
        transform: translateY(0px);
      }
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    @keyframes pulse {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.3);
        opacity: 0.7;
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    }

    @media (min-width: 768px) {
      .image-side {
        display: flex;
      }
      
      .form-side {
        padding: 64px 48px;
      }
      
      .form-header h2 {
        font-size: 28px;
      }
    }

    @media (max-width: 767px) {
      .login-container {
        width: 95%;
        max-width: 450px;
        min-height: auto;
        border-radius: 12px;
      }
      
      .form-side {
        padding: 32px 24px;
      }
      
      .form-header {
        margin-bottom: 24px;
      }
    }

    .app-container {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
  </style>
</head>

<body>
  <div class="app-container">
    <!-- Background Animation Container -->
    <div id="atom-bg" class="atom-bg"></div>
    
    <!-- Login Form -->
    <div class="login-container">
      <div class="premium-badge">PREMIUM</div>
      
      <!-- Lado com imagem/gradiente - apenas vis√≠vel em telas maiores -->
      <div class="image-side">
        <div class="brand-logo">
          <img src="https://i.imgur.com/nDGsGLT.png" alt="NEEXT LTDA Logo" />
          <h1>ùó°ùóòùóòùó´ùóß ùóüùóßùóóùóî</h1>
          <div class="tagline">Plataforma de Gerenciamento</div>
        </div>
      </div>
      
      <!-- Lado do formul√°rio -->
      <div class="form-side">
        <div class="form-header">
          <h2>Bem-vindo(a)</h2>
          <p>Acesse sua conta para continuar</p>
        </div>
        
        <form id="login-form">
          <div class="input-group">
            <label class="label" for="username">Usu√°rio</label>
            <div class="input-container">
              <span class="input-icon">
                <i data-lucide="user"></i>
              </span>
              <input 
                type="text" 
                id="username" 
                placeholder="Digite seu usu√°rio" 
                required
              />
            </div>
          </div>
          
          <div class="input-group">
            <label class="label" for="password">Senha</label>
            <div class="input-container">
              <span class="input-icon">
                <i data-lucide="lock"></i>
              </span>
              <input 
                type="password" 
                id="password" 
                placeholder="Digite sua senha"
                required
              />
              <button 
                type="button" 
                class="password-toggle" 
                id="password-toggle"
              >
                <i data-lucide="eye"></i>
              </button>
            </div>
          </div>
          
          <div class="input-group">
            <label class="label" for="group">Painel</label>
            <div class="input-container">
              <span class="input-icon">
                <i data-lucide="layout-dashboard"></i>
              </span>
              <select id="group" required>
                <option value="" disabled selected>Selecione seu painel</option>
                <option value="love">loveneext</option> 
                <option value="story">story neext</option>   
                <option value="feedback">feedback neext</option>     
                <option value="suporte">suporte</option>                                                          
                <option value="friendship">friendship</option>                                                        
                <option value="amberchat">amber chat</option>
                <option value="amberstickers">amber sticker</option>
                <option value="abinskur">abinskur</option>
                <option value="abinfbi">abinfbi</option>
                <option value="perguntas">perguntas neext</option>
                <option value="correio">correio neext</option>
                <option value="pensador">pensador neext</option>
                <option value="feedback">painel feedback</option>
                <option value="deten√ß√£oskur">deten√ß√£oskur</option>
                <option value="deten√ß√£ofbi">deten√ß√£ofbi</option>
                <option value="paineldiretor">paineldiretor</option>
                <option value="listanegra">listanegra</option>           
                <option value="hospital">hospital</option>                  
                <option value="whitehouse">whitehouse</option>
                <option value="neepool">neepool</option>       
                <option value="skur1">skur1</option>
                <option value="skur2">skur2</option>
                <option value="skur3">skur3</option>
                <option value="skur4">skur4</option>
                <option value="skur5">skur5</option>
                <option value="skur6">skur6</option>
                <option value="fbi1">fbi1</option>
                <option value="fbi2">fbi2</option>
                <option value="fbi3">fbi3</option>
                <option value="fbi4">fbi4</option>
                <option value="fbi5">fbi5</option>
                <option value="fbi6">fbi6</option>
                <option value="fbi7">fbi7</option>
                <option value="fbi8">fbi8</option>
                <option value="fbi9">fbi9</option>
                <option value="fbi10">fbi10</option>
              </select>
            </div>
          </div>
          
          <div class="remember-me">
            <input type="checkbox" id="remember-me" />
            <label for="remember-me">Lembrar senha</label>
          </div>
          
          <button type="submit" class="login-button">
            <i data-lucide="log-in"></i> Entrar
          </button>
        </form>

        <div class="social-buttons">
          <a 
            href="https://instagram.com" 
            target="_blank" 
            rel="noopener noreferrer"
            class="social-button instagram-button"
          >
            <i data-lucide="instagram"></i>
          </a>
          <a 
            href="https://wa.me/message/" 
            target="_blank" 
            rel="noopener noreferrer"
            class="social-button whatsapp-button"
          >
            <i data-lucide="message-circle"></i>
          </a>
        </div>
        
        <div class="form-footer">
          ¬© 2019 ùó¢ùó°ùóòùóòùó´ùóß ùóüùóßùóóùóî. Todos os direitos reservados.
        </div>
      </div>
    </div>
    
    <!-- Loader -->
    <div id="loader-container" class="loader-container">
      <div class="loader">
        <div></div>
        <div></div>
        <div></div>
      </div>
    </div>
  </div>
  
  <!-- Script for the application -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize Lucide icons
      lucide.createIcons();
      
      // Initialize 3D background
      initAtomBackground();
      
      // Setup password toggle functionality
      setupPasswordToggle();
      
      // Setup form submission
      setupLoginForm();
      
      // Check for saved credentials
      checkSavedCredentials();
    });
    
    // Toast notification system
    function showToast(message, type = 'success') {
      // Remove any existing toasts
      const existingToast = document.querySelector('.toast');
      if (existingToast) {
        existingToast.remove();
      }
      
      // Create new toast
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      // Add icon based on type
      let iconName = 'check-circle';
      if (type === 'error') iconName = 'alert-circle';
      if (type === 'warning') iconName = 'alert-triangle';
      
      toast.innerHTML = `<i data-lucide="${iconName}"></i>${message}`;
      document.body.appendChild(toast);
      
      // Create Lucide icon in the toast
      lucide.createIcons({
        icons: {
          'check-circle': true,
          'alert-circle': true,
          'alert-triangle': true
        },
        attrs: {
          class: ['lucide-icon']
        }
      });
      
      // Show toast
      setTimeout(() => {
        toast.classList.add('show');
      }, 10);
      
      // Auto-hide after 5 seconds
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, 5000);
    }
    
    // Toggle password visibility
    function setupPasswordToggle() {
      const passwordInput = document.getElementById('password');
      const toggleButton = document.getElementById('password-toggle');
      
      toggleButton.addEventListener('click', function() {
        const type = passwordInput.getAttribute('type');
        const newType = type === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', newType);
        
        // Corrige o problema do √≠cone desaparecendo
        const iconName = newType === 'text' ? 'eye-off' : 'eye';
        
        // Limpa o bot√£o e cria um novo elemento √≠cone
        toggleButton.innerHTML = '';
        const iconElement = document.createElement('i');
        iconElement.setAttribute('data-lucide', iconName);
        toggleButton.appendChild(iconElement);
        
        // Reinicializa o √≠cone usando o m√©todo correto do Lucide
        lucide.createIcons({
          selector: 'i[data-lucide]',
          nameAttr: 'data-lucide',
        });
      });
    }
    
    // Check for saved credentials in localStorage
    function checkSavedCredentials() {
      const savedUsername = localStorage.getItem('rememberedUsername');
      const savedPassword = localStorage.getItem('rememberedPassword');
      const savedGroup = localStorage.getItem('rememberedGroup');
      
      if (savedUsername && savedPassword && savedGroup) {
        document.getElementById('username').value = savedUsername;
        document.getElementById('password').value = savedPassword;
        document.getElementById('group').value = savedGroup;
        document.getElementById('remember-me').checked = true;
      }
    }
    
    // Setup login form submission
    function setupLoginForm() {
      const form = document.getElementById('login-form');
      const loader = document.getElementById('loader-container');
      
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();
        const group = document.getElementById('group').value;
        const rememberMe = document.getElementById('remember-me').checked;
        
        if (!username || !password || !group) {
          showToast("Por favor, preencha todos os campos!", "warning");
          return;
        }
        
        // Save to localStorage if remember me is checked
        if (rememberMe) {
          localStorage.setItem('rememberedUsername', username);
          localStorage.setItem('rememberedPassword', password);
          localStorage.setItem('rememberedGroup', group);
        } else {
          localStorage.removeItem('rememberedUsername');
          localStorage.removeItem('rememberedPassword');
          localStorage.removeItem('rememberedGroup');
        }
        
        try {
          // Start loading animation
          loader.classList.add('active');
          
          const response = await fetch(
            `https://script.google.com/macros/s/AKfycbwDUfyWsGqSJ8Q9przj7LHxw7zxuvLYd7UfgiCP4F3Fju9i7kB-LtRReQMjpDDw5-Q/exec?action=login&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&group=${encodeURIComponent(group)}`
          );
          
          if (!response.ok) {
            throw new Error("Erro ao conectar com o servidor.");
          }
          
          const result = await response.text();
          const decodedResult = decodeURIComponent(result);
          
          // End loading animation
          loader.classList.remove('active');
          
          if (decodedResult.startsWith("http")) {
            showToast(`Bem-vindo, ${username}! Login realizado com sucesso!`, "success");
            
            setTimeout(() => {
              window.location.href = decodedResult;
            }, 3000);
          } else {
            showToast(decodedResult, "error");
          }
        } catch (error) {
          console.error("Erro ao fazer login:", error);
          loader.classList.remove('active');
          showToast('Ocorreu um erro ao fazer login. Tente novamente.', "error");
        }
      });
    }
    
    // Initialize 3D atom background
    function initAtomBackground() {
      const container = document.getElementById('atom-bg');
      
      // Initialize Three.js scene
      const scene = new THREE.Scene();
      
      // Create camera
      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.z = 30;
      
      // Create renderer
      const renderer = new THREE.WebGLRenderer({ alpha: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0x000000, 0);
      container.appendChild(renderer.domElement);
      
      // Create atom particles (increased count for more density)
      const particlesCount = 300;
      const particles = new THREE.Group();
      scene.add(particles);
      
      // Create particle geometries - varying sizes for cell-like appearance
      const particleGeometries = [
        new THREE.SphereGeometry(0.2, 16, 16),
        new THREE.SphereGeometry(0.3, 16, 16),
        new THREE.SphereGeometry(0.15, 12, 12),
      ];
      
      // Create varying colors for a more organic look
      const particleColors = [
        0x8B5CF6, // Purple
        0xD946EF, // Pink
        0x2563EB, // Blue
        0x3B82F6, // Light blue
        0x10B981, // Green
      ];
      
      // Create particle materials with glow effect
      const particleMaterials = particleColors.map(color => 
        new THREE.MeshBasicMaterial({
          color: color,
          transparent: true,
          opacity: 0.7,
        })
      );
      
      // Create particles and add to group
      for (let i = 0; i < particlesCount; i++) {
        // Randomly select geometry and material
        const geometry = particleGeometries[Math.floor(Math.random() * particleGeometries.length)];
        const material = particleMaterials[Math.floor(Math.random() * particleMaterials.length)];
        
        const particle = new THREE.Mesh(geometry, material);
        
        // More varied random positions for particles
        particle.position.x = (Math.random() - 0.5) * 90;
        particle.position.y = (Math.random() - 0.5) * 90;
        particle.position.z = (Math.random() - 0.5) * 90;
        
        // More varied random properties for animation
        particle.userData = {
          speed: Math.random() * 0.2,
          rotationSpeed: Math.random() * 0.03,
          orbitRadius: Math.random() * 3 + 0.5,
          orbitOffset: Math.random() * Math.PI * 2,
          pulseSpeed: Math.random() * 0.01,
          originalScale: 0.8 + Math.random() * 0.4,
          cellType: Math.random() > 0.7 ? 'cell' : 'atom', // Some particles act like cells
        };
        
        // Set initial scale
        particle.scale.set(
          particle.userData.originalScale,
          particle.userData.originalScale,
          particle.userData.originalScale
        );
        
        particles.add(particle);
      }
      
      // Create nucleus clusters (cell centers) - random clusters of particles
      const nucleusCount = 10;
      const nuclei = [];
      
      for (let i = 0; i < nucleusCount; i++) {
        const position = new THREE.Vector3(
          (Math.random() - 0.5) * 60,
          (Math.random() - 0.5) * 60,
          (Math.random() - 0.5) * 60
        );
        
        const nucleus = {
          position: position,
          radius: 8 + Math.random() * 5,
          rotationAxis: new THREE.Vector3(
            Math.random() - 0.5,
            Math.random() - 0.5,
            Math.random() - 0.5
          ).normalize(),
          rotationSpeed: 0.001 + Math.random() * 0.002
        };
        
        nuclei.push(nucleus);
      }
      
      // Create connections between nearby particles
      const lineMaterial = new THREE.LineBasicMaterial({
        color: 0xD946EF,
        transparent: true,
        opacity: 0.2,
      });
      
      const blueLineMaterial = new THREE.LineBasicMaterial({
        color: 0x3B82F6,
        transparent: true,
        opacity: 0.2,
      });
      
      const connections = [];
      
      // Function to create connections between particles
      const createConnections = () => {
        // Remove old connections
        connections.forEach(line => scene.remove(line));
        connections.length = 0;
        
        // Create new connections based on current particle positions
        for (let i = 0; i < particles.children.length; i++) {
          const particleA = particles.children[i];
          
          for (let j = i + 1; j < particles.children.length; j++) {
            const particleB = particles.children[j];
            
            // Calculate distance between particles
            const distance = particleA.position.distanceTo(particleB.position);
            
            // Create connection if particles are close enough (varied connection distance)
            if (distance < 8 + Math.random() * 4) {
              const geometry = new THREE.BufferGeometry().setFromPoints([
                particleA.position,
                particleB.position,
              ]);
              
              // Alternate connection colors
              const material = Math.random() > 0.5 ? lineMaterial : blueLineMaterial;
              const line = new THREE.Line(geometry, material);
              scene.add(line);
              connections.push(line);
            }
          }
        }
      };
      
      // Add orbital rings around some nuclei for atom-like appearance
      const orbitalRings = [];
      
      nuclei.slice(0, 5).forEach(nucleus => {
        const ringGeometry = new THREE.TorusGeometry(nucleus.radius, 0.05, 16, 100);
        const ringMaterial = new THREE.MeshBasicMaterial({ 
          color: 0x8B5CF6, 
          transparent: true, 
          opacity: 0.3 
        });
        
        // Create 1-3 orbital rings per nucleus
        const ringCount = Math.floor(Math.random() * 3) + 1;
        
        for (let i = 0; i < ringCount; i++) {
          const ring = new THREE.Mesh(ringGeometry, ringMaterial);
          ring.position.copy(nucleus.position);
          
          // Random rotation for each ring
          ring.rotation.x = Math.random() * Math.PI;
          ring.rotation.y = Math.random() * Math.PI;
          
          scene.add(ring);
          
          // Add user data for animation
          ring.userData = {
            rotationAxis: new THREE.Vector3(
              Math.random() - 0.5,
              Math.random() - 0.5,
              Math.random() - 0.5
            ).normalize(),
            rotationSpeed: 0.003 + Math.random() * 0.005
          };
          
          orbitalRings.push(ring);
        }
      });
      
      // Handle window resize
      const handleResize = () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      };
      
      window.addEventListener('resize', handleResize);
      
      // Helper function for nucleus influence calculation
      const calculateNucleusInfluence = (particle, time) => {
        let influenceX = 0;
        let influenceY = 0;
        let influenceZ = 0;
        
        nuclei.forEach(nucleus => {
          const distance = particle.position.distanceTo(nucleus.position);
          if (distance < nucleus.radius * 2) {
            const force = 0.02 * (nucleus.radius / (distance + 1));
            
            // Vector toward nucleus
            const dirX = (nucleus.position.x - particle.position.x);
            const dirY = (nucleus.position.y - particle.position.y);
            const dirZ = (nucleus.position.z - particle.position.z);
            
            // Add orbital motion around nucleus
            const orbitFactor = 0.003;
            influenceX += dirY * orbitFactor - dirX * force;
            influenceY += -dirX * orbitFactor - dirY * force;
            influenceZ += dirZ * orbitFactor - dirZ * force;
          }
        });
        
        return { influenceX, influenceY, influenceZ };
      };
      
      // Animation loop
      let frameCount = 0;
      const animate = () => {
        requestAnimationFrame(animate);
        frameCount++;
        
        // Slow rotation of the entire particle system
        particles.rotation.x += 0.0003;
        particles.rotation.y += 0.0005;
        
        // Get current time for animations
        const time = Date.now() * 0.001;
        
        // Animate individual particles
        particles.children.forEach((particle) => {
          const { 
            speed, 
            rotationSpeed, 
            orbitOffset,
            pulseSpeed,
            originalScale,
            cellType
          } = particle.userData;
          
          // Calculate nucleus influence
          const { influenceX, influenceY, influenceZ } = calculateNucleusInfluence(particle, time);
          
          // Move particles in orbit-like paths
          const particleTime = time * speed;
          
          if (cellType === 'cell') {
            // Cell-like behavior - slower, more drifting
            particle.position.x += Math.sin(particleTime + orbitOffset) * 0.01 + influenceX;
            particle.position.y += Math.cos(particleTime + orbitOffset) * 0.01 + influenceY;
            particle.position.z += Math.sin(particleTime * 0.7) * 0.01 + influenceZ;
          } else {
            // Atom-like behavior - more orbital
            particle.position.x += Math.sin(particleTime + orbitOffset) * 0.02 + influenceX;
            particle.position.y += Math.cos(particleTime + orbitOffset) * 0.02 + influenceY;
            particle.position.z += Math.sin(particleTime * 1.3) * 0.02 + influenceZ;
          }
          
          // Pulse effect - scale up and down
          const pulse = Math.sin(time * pulseSpeed * 5) * 0.1 + 1;
          particle.scale.set(
            originalScale * pulse,
            originalScale * pulse,
            originalScale * pulse
          );
          
          // Rotate particles
          particle.rotation.x += rotationSpeed;
          particle.rotation.y += rotationSpeed * 0.8;
        });
        
        // Rotate orbital rings
        orbitalRings.forEach(ring => {
          const { rotationAxis, rotationSpeed } = ring.userData;
          ring.rotateOnAxis(rotationAxis, rotationSpeed);
        });
        
        // Update connections periodically for performance
        if (frameCount % 30 === 0) {
          createConnections();
        }
        
        // Move particles back into view if they drift too far
        if (frameCount % 120 === 0) {
          particles.children.forEach(particle => {
            const distance = particle.position.length();
            if (distance > 100) {
              // Reset to a position closer to center
              particle.position.multiplyScalar(0.5);
            }
          });
        }
        
        renderer.render(scene, camera);
      };
      
      animate();
      
      // Setup cleanup function
      return function cleanup() {
        window.removeEventListener('resize', handleResize);
        
        if (container.contains(renderer.domElement)) {
          container.removeChild(renderer.domElement);
        }
        
        // Dispose of geometries and materials
        particleGeometries.forEach(geometry => geometry.dispose());
        particleMaterials.forEach(material => material.dispose());
        lineMaterial.dispose();
        blueLineMaterial.dispose();
        
        // Dispose of orbital rings
        orbitalRings.forEach(ring => {
          ring.geometry.dispose();
          scene.remove(ring);
        });
        
        connections.forEach(line => {
          line.geometry.dispose();
          scene.remove(line);
        });
        
        // Remove particles
        particles.children.forEach(particle => {
          particles.remove(particle);
        });
        
        scene.remove(particles);
        renderer.dispose();
      };
    }
  </script>
</body>
</html>
