
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#8b5cf6">
  <meta name="description" content="Correios da Neext - Mail Application">
  <title>Correios da Neext</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    :root {
      --background: 210 40% 98%;
      --foreground: 222.2 84% 4.9%;
      --card: 0 0% 100%;
      --card-foreground: 222.2 84% 4.9%;
      --popover: 0 0% 100%;
      --popover-foreground: 222.2 84% 4.9%;
      --primary: 262 83% 58%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96.1%;
      --secondary-foreground: 222.2 47.4% 11.2%;
      --muted: 210 40% 96.1%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 262 83% 58%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 40% 98%;
      --border: 214.3 31.8% 91.4%;
      --input: 214.3 31.8% 91.4%;
      --ring: 262 83% 58%;
      --radius: 0.75rem;
    }

    .dark {
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --card: 222.2 84% 4.9%;
      --card-foreground: 210 40% 98%;
      --popover: 222.2 84% 4.9%;
      --popover-foreground: 210 40% 98%;
      --primary: 262 83% 58%;
      --primary-foreground: 210 40% 98%;
      --secondary: 217.2 32.6% 17.5%;
      --secondary-foreground: 210 40% 98%;
      --muted: 217.2 32.6% 17.5%;
      --muted-foreground: 215 20.2% 65.1%;
      --accent: 262 83% 58%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 40% 98%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
      --ring: 262.1 83.3% 57.8%;
    }

    * {
      border-color: hsl(var(--border));
    }

    body {
      background-color: hsl(var(--background));
      color: hsl(var(--foreground));
      transition-property: color, background-color, border-color;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 300ms;
    }

    .glass {
      background-color: hsla(var(--background), 0.8);
      backdrop-filter: blur(24px);
      border: 1px solid hsl(var(--border));
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    }

    .card-transition {
      transition-property: all;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 300ms;
    }

    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    @keyframes slide-in {
      from { 
        transform: translateY(10px);
        opacity: 0;
      }
      to { 
        transform: translateY(0);
        opacity: 1;
      }
    }

    .animate-fade-in {
      animation: fade-in 0.3s ease-out forwards;
    }

    .animate-slide-in {
      animation: slide-in 0.3s ease-out forwards;
    }

    .animate-pulse {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: .5;
      }
    }

    [data-theme="dark"] .bg-card {
      background-color: hsl(var(--card));
    }

    [data-theme="light"] .bg-card {
      background-color: hsl(var(--card));
    }

    .bg-primary {
      background-color: hsl(var(--primary));
    }

    .text-primary {
      color: hsl(var(--primary));
    }

    .text-primary-foreground {
      color: hsl(var(--primary-foreground));
    }

    .bg-muted {
      background-color: hsl(var(--muted));
    }

    .text-muted-foreground {
      color: hsl(var(--muted-foreground));
    }

    .text-card-foreground {
      color: hsl(var(--card-foreground));
    }

    .border-border {
      border-color: hsl(var(--border));
    }

    .bg-orange-100 {
      background-color: #ffedd5;
    }

    .dark .bg-orange-900\/30 {
      background-color: rgba(124, 45, 18, 0.3);
    }

    .text-orange-600 {
      color: #ea580c;
    }

    .dark .text-orange-400 {
      color: #fb923c;
    }
  </style>
</head>
<body>
  <div id="app" class="flex min-h-screen flex-col bg-background">
    <!-- Header -->
    <header class="sticky top-0 z-40 border-b bg-background/95 backdrop-blur">
      <div class="container mx-auto flex h-16 items-center justify-between px-4 md:px-6">
        <div class="flex items-center gap-2">
          <svg class="h-6 w-6 text-primary" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
            <path d="M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5"></path>
            <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
            <path d="M18 15.28c.2-.4.5-.8.9-1a2.1 2.1 0 0 1 2.6.4c.3.4.5.8.5 1.3 0 1.3-2 2-2 2"></path>
            <path d="M20 22v.01"></path>
          </svg>
          <h1 class="text-xl font-semibold text-foreground">Correios da Neext</h1>
        </div>
        <div class="flex items-center gap-2">
          <button id="theme-toggle" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 w-10">
            <svg id="sun-icon" class="h-6 w-6" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <circle cx="12" cy="12" r="4"></circle>
              <path d="M12 2v2"></path>
              <path d="M12 20v2"></path>
              <path d="m4.93 4.93 1.41 1.41"></path>
              <path d="m17.66 17.66 1.41 1.41"></path>
              <path d="M2 12h2"></path>
              <path d="M20 12h2"></path>
              <path d="m6.34 17.66-1.41 1.41"></path>
              <path d="m19.07 4.93-1.41 1.41"></path>
            </svg>
            <svg id="moon-icon" class="h-6 w-6 hidden" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
            </svg>
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1">
      <div class="container mx-auto py-6 px-4 md:py-10 md:px-6">
        <div class="mb-8 flex flex-col items-center space-y-4">
          <h1 class="text-3xl font-bold tracking-tight text-foreground">Mensagens Enviadas</h1>
          <p class="text-muted-foreground" id="message-count">
            Total de Correios: 0
          </p>
        </div>

        <div class="mb-8 flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
          <!-- Search Bar -->
          <div class="relative w-full max-w-md">
            <svg class="absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
            <input id="search-input" class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 pl-8 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50" placeholder="Pesquisar mensagens..." type="search">
          </div>

          <!-- Filter -->
          <div class="inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground">
            <button class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm" data-filter="all" data-state="active">Todos</button>
            <button class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm" data-filter="recent">Últimas 24h</button>
            <button class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm" data-filter="week">Esta semana</button>
            <button class="inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm" data-filter="month">Este mês</button>
          </div>
        </div>

        <!-- Message Container -->
        <div id="loading" class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
          <!-- Loading skeletons will be inserted here -->
        </div>

        <div id="no-messages" class="hidden flex h-[400px] flex-col items-center justify-center rounded-lg border bg-card p-8 text-center animate-fade-in">
          <div class="text-muted-foreground mb-2">
            <svg class="mx-auto h-12 w-12" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5"></path>
              <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
              <path d="M18 15.28c.2-.4.5-.8.9-1a2.1 2.1 0 0 1 2.6.4c.3.4.5.8.5 1.3 0 1.3-2 2-2 2"></path>
              <path d="M20 22v.01"></path>
            </svg>
          </div>
          <h3 class="text-xl font-semibold text-foreground">Nenhuma mensagem encontrada</h3>
          <p class="text-muted-foreground mt-2">
            Tente ajustar seus filtros ou termo de pesquisa.
          </p>
        </div>

        <div id="mensagens" class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
          <!-- Messages will be inserted here -->
        </div>
      </div>
    </main>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-0 right-0 z-50 flex flex-col gap-2 p-4 max-w-sm"></div>
  </div>

  <script>
    // Theme switcher
    document.addEventListener('DOMContentLoaded', function() {
      // Theme detection
      const themeToggle = document.getElementById('theme-toggle');
      const sunIcon = document.getElementById('sun-icon');
      const moonIcon = document.getElementById('moon-icon');
      
      const getPreferredTheme = () => {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) return savedTheme;
        
        return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      };
      
      const setTheme = (theme) => {
        document.documentElement.setAttribute('data-theme', theme);
        if (theme === 'dark') {
          document.documentElement.classList.add('dark');
          sunIcon.classList.add('hidden');
          moonIcon.classList.remove('hidden');
        } else {
          document.documentElement.classList.remove('dark');
          sunIcon.classList.remove('hidden');
          moonIcon.classList.add('hidden');
        }
        localStorage.setItem('theme', theme);
      };
      
      // Initialize theme
      setTheme(getPreferredTheme());
      
      // Theme toggle
      themeToggle.addEventListener('click', () => {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        setTheme(newTheme);
      });

      // Messages logic
      let messages = [];
      let filteredMessages = [];
      let activeFilter = 'all';
      let searchTerm = '';

      // Show toast function
      function showToast(title, description, variant = 'default') {
        const toastContainer = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `p-4 rounded-md border shadow-lg transition-all animate-fade-in ${variant === 'destructive' ? 'bg-destructive text-destructive-foreground border-destructive' : 'bg-background text-foreground border-border'}`;
        toast.innerHTML = `
          <div class="grid gap-1">
            ${title ? `<div class="text-sm font-semibold">${title}</div>` : ''}
            ${description ? `<div class="text-sm opacity-90">${description}</div>` : ''}
          </div>
          <button class="absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100">
            <svg class="h-4 w-4" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
              <path d="M18 6 6 18"></path>
              <path d="m6 6 12 12"></path>
            </svg>
          </button>
        `;
        
        toastContainer.appendChild(toast);
        
        // Remove toast after 5 seconds
        setTimeout(() => {
          toast.classList.add('opacity-0');
          setTimeout(() => {
            toast.remove();
          }, 300);
        }, 5000);
      }

      // Fetch messages
      async function fetchMessages() {
        showLoadingSkeletons();
        
        try {
          const response = await fetch(
            "https://script.google.com/macros/s/AKfycbz1ftxB9DiRF8Ju0ecbAxE2tCzxGKRkTOciD5xLRklsJli8rMzfSuY5liwrTwFBJ_q8/exec",
            {
              method: "GET",
              mode: "cors",
            }
          );
          
          if (!response.ok) {
            throw new Error("Failed to fetch messages");
          }
          
          const data = await response.json();
          messages = data.reverse();
          filteredMessages = [...messages];
          
          // Update message count
          document.getElementById('message-count').textContent = `Total de Correios: ${filteredMessages.length}`;
          
          renderMessages();
        } catch (error) {
          console.error("Error fetching messages:", error);
          showToast(
            "Erro", 
            "Não foi possível carregar as mensagens.", 
            "destructive"
          );
          document.getElementById('loading').style.display = 'none';
          document.getElementById('no-messages').style.display = 'flex';
        }
      }

      // Show loading skeletons
      function showLoadingSkeletons() {
        const loadingContainer = document.getElementById('loading');
        loadingContainer.innerHTML = '';
        
        for (let i = 0; i < 6; i++) {
          loadingContainer.innerHTML += `
            <div class="animate-pulse rounded-xl border bg-card p-6 shadow-sm">
              <div class="h-6 w-1/2 rounded-md bg-muted mb-4"></div>
              <div class="h-32 rounded-md bg-muted mb-4"></div>
              <div class="h-4 w-1/4 rounded-md bg-muted"></div>
            </div>
          `;
        }
      }

      // Calculate time ago
      function timeAgo(date) {
        const now = new Date();
        const past = new Date(date);
        const diff = Math.abs(now.getTime() - past.getTime());
        const minutes = Math.floor(diff / (1000 * 60));
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));

        if (minutes < 60) {
          return `${minutes} minutos atrás`;
        } else if (hours < 24) {
          return `${hours} horas atrás`;
        } else {
          return `${days} dias atrás`;
        }
      }

      // Render messages
      function renderMessages() {
        const messageContainer = document.getElementById('mensagens');
        const loadingContainer = document.getElementById('loading');
        const noMessagesContainer = document.getElementById('no-messages');
        
        // Hide loading, show appropriate container
        loadingContainer.style.display = 'none';
        
        if (filteredMessages.length === 0) {
          messageContainer.style.display = 'none';
          noMessagesContainer.style.display = 'flex';
          return;
        }
        
        messageContainer.style.display = 'grid';
        noMessagesContainer.style.display = 'none';
        
        // Clear container
        messageContainer.innerHTML = '';
        
        // Add messages
        filteredMessages.forEach((item, index) => {
          const messageCard = document.createElement('div');
          messageCard.className = 'bg-card border border-border rounded-xl shadow-sm overflow-hidden transition-all duration-300 hover:shadow-md animate-slide-in';
          messageCard.style.animationDelay = `${index * 0.05}s`;
          
          messageCard.innerHTML = `
            <div class="bg-gradient-to-r from-primary to-primary/80 text-primary-foreground text-center py-3 font-semibold flex items-center justify-center">
              <svg class="lucide lucide-mail-question mr-2" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                <path d="M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5"></path>
                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
                <path d="M18 15.28c.2-.4.5-.8.9-1a2.1 2.1 0 0 1 2.6.4c.3.4.5.8.5 1.3 0 1.3-2 2-2 2"></path>
                <path d="M20 22v.01"></path>
              </svg>
              Correio Anônimo
            </div>
            <div class="p-6">
              <div class="flex justify-between items-center mb-4">
                <div class="text-muted-foreground text-sm">${timeAgo(item.data)}</div>
              </div>
              <div class="text-card-foreground text-lg mb-4 leading-relaxed flex items-start">
                <svg class="lucide lucide-languages mr-2 flex-shrink-0 mt-1" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <path d="m5 8 6 6"></path>
                  <path d="m4 14 6-6 2-3"></path>
                  <path d="M2 5h12"></path>
                  <path d="M7 2h1"></path>
                  <path d="m22 22-5-10-5 10"></path>
                  <path d="M14 18h6"></path>
                </svg>
                ${item.mensagem}
              </div>
              <div class="flex items-center space-x-2 mb-4">
                <svg class="lucide lucide-syringe mr-2" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <path d="m18 2 4 4"></path>
                  <path d="m17 7 3-3"></path>
                  <path d="M19 9 8.7 19.3c-1 1-2.5 1-3.4 0l-.6-.6c-1-1-1-2.5 0-3.4L15 5"></path>
                  <path d="m9 11 4 4"></path>
                  <path d="m5 19-3 3"></path>
                  <path d="m14 4 6 6"></path>
                </svg>
                <div class="bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 px-3 py-1 rounded-full text-sm">
                  Enviado para: ${item.nome}
                </div>
              </div>
              <div class="flex justify-end">
                <button class="text-primary text-sm flex items-center hover:underline">
                  <svg class="lucide lucide-user-round mr-1" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="8" r="5"></circle>
                    <path d="M20 21a8 8 0 0 0-16 0"></path>
                  </svg>
                  Anônimo(a)
                </button>
              </div>
            </div>
            <div class="bg-card border-t border-border p-4 flex justify-between items-center">
              <div class="flex items-center">
                <svg class="lucide lucide-mails mr-2" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <rect height="13" rx="2" width="16" x="6" y="4"></rect>
                  <path d="m22 7-7.1 3.78c-.57.3-1.23.3-1.8 0L6 7"></path>
                  <path d="M2 8v11c0 1.1.9 2 2 2h14"></path>
                </svg>
                <span class="text-muted-foreground text-sm">NEEXT CORREIO</span>
              </div>
              <div class="flex items-center space-x-2">
                <svg class="lucide lucide-chrome" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="12" cy="12" r="10"></circle>
                  <circle cx="12" cy="12" r="4"></circle>
                  <line x1="21.17" x2="12" y1="8" y2="8"></line>
                  <line x1="3.95" x2="8.54" y1="6.06" y2="14"></line>
                  <line x1="10.88" x2="15.46" y1="21.94" y2="14"></line>
                </svg>
                <svg class="lucide lucide-biohazard" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="12" cy="11.9" r="2"></circle>
                  <path d="M6.7 3.4c-.9 2.5 0 5.2 2.2 6.7C6.5 9 3.7 9.6 2 11.6"></path>
                  <path d="m8.9 10.1 1.4.8"></path>
                  <path d="M17.3 3.4c.9 2.5 0 5.2-2.2 6.7 2.4-1.2 5.2-.6 6.9 1.5"></path>
                  <path d="m15.1 10.1-1.4.8"></path>
                  <path d="M16.7 20.8c-2.6-.4-4.6-2.6-4.7-5.3-.2 2.6-2.1 4.8-4.7 5.2"></path>
                  <path d="M12 13.9v1.6"></path>
                  <path d="M13.5 5.4c-1-.2-2-.2-3 0"></path>
                  <path d="M17 16.4c.7-.7 1.2-1.6 1.5-2.5"></path>
                  <path d="M5.5 13.9c.3.9.8 1.8 1.5 2.5"></path>
                </svg>
                <svg class="lucide lucide-plug-2" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 2v6"></path>
                  <path d="M15 2v6"></path>
                  <path d="M12 17v5"></path>
                  <path d="M5 8h14"></path>
                  <path d="M6 11V8h12v3a6 6 0 1 1-12 0Z"></path>
                </svg>
              </div>
            </div>
          `;
          
          messageContainer.appendChild(messageCard);
        });
      }

      // Filter and search messages
      function filterAndSearchMessages() {
        let filtered = [...messages];
        
        // Filter by date
        if (activeFilter !== "all") {
          const now = new Date();
          filtered = filtered.filter((message) => {
            const messageDate = new Date(message.data);
            const diffTime = Math.abs(now.getTime() - messageDate.getTime());
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            switch (activeFilter) {
              case "recent":
                return diffDays <= 1;
              case "week":
                return diffDays <= 7;
              case "month":
                return diffDays <= 30;
              default:
                return true;
            }
          });
        }
        
        // Filter by search term
        if (searchTerm) {
          const searchLower = searchTerm.toLowerCase();
          filtered = filtered.filter(
            (message) =>
              message.mensagem.toLowerCase().includes(searchLower) ||
              message.nome.toLowerCase().includes(searchLower)
          );
        }
        
        filteredMessages = filtered;
        
        // Update message count
        document.getElementById('message-count').textContent = `Total de Correios: ${filteredMessages.length}`;
        
        renderMessages();
      }

      // Event listeners for filters
      document.querySelectorAll('[data-filter]').forEach(button => {
        button.addEventListener('click', function() {
          // Remove active state from all buttons
          document.querySelectorAll('[data-filter]').forEach(btn => {
            btn.setAttribute('data-state', '');
          });
          
          // Set active state on clicked button
          this.setAttribute('data-state', 'active');
          
          // Update active filter
          activeFilter = this.getAttribute('data-filter');
          
          // Filter and render messages
          filterAndSearchMessages();
        });
      });

      // Event listener for search
      document.getElementById('search-input').addEventListener('input', function() {
        searchTerm = this.value;
        filterAndSearchMessages();
      });

      // Fetch messages on load
      fetchMessages();
    });
  </script>
</body>
</html>
