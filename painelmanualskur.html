
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual de Cargos</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --background: 210 40% 98%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%;
            --popover-foreground: 222.2 84% 4.9%;
            --primary: 210 100% 50%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96.1%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96.1%;
            --accent-foreground: 222.2 47.4% 11.2%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 222.2 84% 4.9%;
            --radius: 0.75rem;
        }

        .dark {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --popover: 222.2 84% 4.9%;
            --popover-foreground: 210 40% 98%;
            --primary: 210 100% 50%;
            --primary-foreground: 222.2 47.4% 11.2%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 217.2 32.6% 17.5%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 210 40% 98%;
            --border: 217.2 32.6% 17.5%;
            --input: 217.2 32.6% 17.5%;
            --ring: 212.7 26.8% 83.9%;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition-property: background-color, border-color, color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 150ms;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .sticky {
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header {
            width: 100%;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .header.scrolled {
            background-color: hsla(var(--background), 0.8);
            box-shadow: 0 1px 3px hsla(var(--foreground), 0.1);
        }

        .header-content {
            display: flex;
            height: 4rem;
            align-items: center;
            justify-content: space-between;
        }

        .nav-title {
            font-size: 1.125rem;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            padding: 0.5rem;
            background: transparent;
            border: none;
            cursor: pointer;
            color: hsl(var(--foreground));
        }

        .toggle-button:hover {
            background-color: hsl(var(--muted));
        }

        .toggle-button svg {
            height: 1rem;
            width: 1rem;
        }

        .button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.375rem;
            font-weight: 500;
            font-size: 0.875rem;
            height: 2.5rem;
            padding-left: 1rem;
            padding-right: 1rem;
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }

        .button:hover {
            background-color: hsla(var(--primary), 0.9);
            transform: scale(1.05);
        }

        .button:active {
            transform: scale(0.95);
        }

        .button svg {
            margin-right: 0.5rem;
            height: 1rem;
            width: 1rem;
        }

        .search-container {
            position: relative;
            width: 100%;
            max-width: 36rem;
            margin: 0 auto 2rem;
        }

        .search-input {
            width: 100%;
            height: 2.75rem;
            padding-left: 2.25rem;
            padding-right: 2.25rem;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--input));
            background-color: transparent;
            color: hsl(var(--foreground));
            font-size: 0.875rem;
            transition: 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: hsl(var(--primary));
            box-shadow: 0 0 0 2px hsla(var(--primary), 0.3);
        }

        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            height: 1rem;
            width: 1rem;
            color: hsl(var(--muted-foreground));
        }

        .search-clear {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            height: 1rem;
            width: 1rem;
            color: hsl(var(--muted-foreground));
            cursor: pointer;
            background: none;
            border: none;
            padding: 0.25rem;
            border-radius: 50%;
        }

        .search-clear:hover {
            background-color: hsl(var(--muted));
        }

        .search-hint {
            text-align: center;
            margin-top: 0.25rem;
            font-size: 0.75rem;
            color: hsl(var(--muted-foreground));
        }

        .kbd {
            background-color: hsl(var(--muted));
            padding: 0 0.375rem;
            line-height: 1.25;
            border-radius: 0.25rem;
            font-size: 0.625rem;
            border: 1px solid hsl(var(--border));
        }

        .total-cargos {
            text-align: center;
            margin-bottom: 1.5rem;
            color: hsl(var(--muted-foreground));
        }

        .total-value {
            font-weight: 500;
            color: hsl(var(--foreground));
        }

        .category-section {
            margin-bottom: 2.5rem;
            animation: fadeUp 0.5s ease-out;
        }

        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .category-badge {
            height: 2rem;
            display: flex;
            align-items: center;
            padding: 0 0.75rem;
            border-radius: 9999px;
            background-color: hsla(var(--primary), 0.1);
            color: hsl(var(--primary));
            font-size: 0.875rem;
            font-weight: 500;
        }

        .category-count {
            margin-left: 0.75rem;
            font-size: 0.75rem;
            color: hsl(var(--muted-foreground));
        }

        .category-divider {
            height: 1px;
            flex: 1;
            margin-left: auto;
            background-color: hsl(var(--border));
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .card-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .card-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .card {
            width: 100%;
            height: 100%;
            border-radius: 0.75rem;
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--card));
            color: hsl(var(--card-foreground));
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        .card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }

        .card-content {
            padding: 1.25rem;
            height: calc(100% - 3rem);
        }

        .card-title {
            font-weight: 500;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-description {
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            white-space: pre-wrap;
            overflow-y: auto;
            max-height: 9rem;
        }

        .card-footer {
            padding: 0.75rem;
            padding-top: 0;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            border-top: 1px solid hsla(var(--muted), 0.2);
            background-color: hsla(var(--muted), 0.2);
        }

        .icon-button {
            height: 2rem;
            width: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            background: transparent;
            border: none;
            cursor: pointer;
            color: hsl(var(--foreground));
        }

        .icon-button:hover {
            background-color: hsl(var(--muted));
        }

        .icon-button.delete {
            color: hsl(var(--destructive));
        }

        .icon-button.delete:hover {
            background-color: hsla(var(--destructive), 0.1);
        }

        .icon-button svg {
            height: 1rem;
            width: 1rem;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 16rem;
        }

        .spinner {
            height: 2rem;
            width: 2rem;
            border-radius: 50%;
            border-top: 2px solid hsl(var(--primary));
            animation: spin 1s linear infinite;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 0;
        }

        .empty-title {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .empty-message {
            color: hsl(var(--muted-foreground));
        }

        .tooltip {
            position: relative;
        }

        .tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 0.5rem;
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            background-color: hsl(var(--popover));
            color: hsl(var(--popover-foreground));
            font-size: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            white-space: nowrap;
            z-index: 50;
        }

        .tooltip:hover .tooltip-content {
            opacity: 1;
            visibility: visible;
        }

        /* Dialog styles */
        .dialog-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .dialog {
            background-color: hsl(var(--background));
            border-radius: 0.75rem;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            animation: scaleIn 0.2s ease-out;
            overflow: hidden;
        }

        .dialog-header {
            padding: 1.5rem 1.5rem 0.5rem;
        }

        .dialog-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .dialog-description {
            color: hsl(var(--muted-foreground));
            font-size: 0.875rem;
        }

        .dialog-content {
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .form-input, .form-textarea {
            height: 2.5rem;
            width: 100%;
            border-radius: 0.375rem;
            border: 1px solid hsl(var(--input));
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            padding: 0 0.75rem;
            font-size: 0.875rem;
        }

        .form-input:focus, .form-textarea:focus {
            outline: none;
            border-color: hsl(var(--primary));
            box-shadow: 0 0 0 2px hsla(var(--primary), 0.2);
        }

        .form-textarea {
            height: 7.5rem;
            padding: 0.5rem 0.75rem;
            resize: vertical;
        }

        .form-error {
            color: hsl(var(--destructive));
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }

        .dialog-footer {
            padding: 1rem 1.5rem 1.5rem;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        .button-outline {
            background-color: transparent;
            color: hsl(var(--foreground));
            border: 1px solid hsl(var(--border));
        }

        .button-outline:hover {
            background-color: hsl(var(--muted));
            transform: none;
        }

        /* Alert dialog styles */
        .alert-dialog-content {
            width: 100%;
            max-width: 28rem;
            padding: 1.5rem;
        }

        .alert-dialog-header {
            margin-bottom: 1rem;
        }

        .alert-dialog-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .alert-dialog-description {
            color: hsl(var(--muted-foreground));
            font-size: 0.875rem;
        }

        .alert-dialog-footer {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .destructive-button {
            background-color: hsl(var(--destructive));
            color: hsl(var(--destructive-foreground));
        }

        .destructive-button:hover {
            background-color: hsla(var(--destructive), 0.9);
        }

        /* Toast styles */
        .toast-container {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .toast {
            min-width: 18rem;
            border-radius: 0.375rem;
            padding: 0.75rem 1rem;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid hsl(var(--border));
            font-size: 0.875rem;
            animation: slideIn 0.2s ease-out;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toast.success {
            border-left: 4px solid #10b981;
        }

        .toast.error {
            border-left: 4px solid #ef4444;
        }

        .toast-icon {
            flex-shrink: 0;
        }

        .toast-content {
            flex: 1;
        }

        /* Animations */
        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Screen reader only */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
    </style>
</head>
<body>
    <div id="app">
        <header class="sticky header">
            <div class="container header-content">
                <div class="nav-title">Manual de Cargos</div>
                <div class="header-actions">
                    <button id="theme-toggle" class="toggle-button" aria-label="Alternar tema" title="Alternar tema">
                        <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
                            <circle cx="12" cy="12" r="4"></circle>
                            <path d="M12 2v2"></path>
                            <path d="M12 20v2"></path>
                            <path d="m4.93 4.93 1.41 1.41"></path>
                            <path d="m17.66 17.66 1.41 1.41"></path>
                            <path d="M2 12h2"></path>
                            <path d="M20 12h2"></path>
                            <path d="m6.34 17.66-1.41 1.41"></path>
                            <path d="m19.07 4.93-1.41 1.41"></path>
                        </svg>
                        <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
                        </svg>
                    </button>
                    <button id="add-button" class="button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M5 12h14"></path>
                            <path d="M12 5v14"></path>
                        </svg>
                        Adicionar
                    </button>
                </div>
            </div>
        </header>

        <main class="container py-8">
            <div class="search-container">
                <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.3-4.3"></path>
                </svg>
                <input id="search-input" class="search-input" type="text" placeholder="Pesquisar cargos... (⌘K)">
                <button id="search-clear" class="search-clear" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"></path>
                        <path d="m6 6 12 12"></path>
                    </svg>
                </button>
                <div class="search-hint">
                    Pressione <kbd class="kbd">⌘K</kbd> para pesquisar
                </div>
            </div>

            <div class="total-cargos">
                Total de Cargos: <span id="total-count" class="total-value">0</span>
            </div>

            <div id="content-container">
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </main>

        <!-- Job Form Dialog -->
        <div id="job-form-dialog" class="dialog-backdrop" style="display: none;">
            <div class="dialog">
                <div class="dialog-header">
                    <h3 id="dialog-title" class="dialog-title">Adicionar Cargo</h3>
                    <p class="dialog-description">Preencha os campos abaixo para adicionar um novo cargo.</p>
                </div>
                <form id="job-form" class="dialog-content">
                    <input type="hidden" id="job-id">
                    <div class="form-item">
                        <label for="job-categoria" class="form-label">Categoria</label>
                        <input id="job-categoria" type="text" class="form-input" placeholder="Digite a categoria" required>
                        <div id="categoria-error" class="form-error"></div>
                    </div>
                    <div class="form-item">
                        <label for="job-titulo" class="form-label">Título</label>
                        <input id="job-titulo" type="text" class="form-input" placeholder="Digite o título" required>
                        <div id="titulo-error" class="form-error"></div>
                    </div>
                    <div class="form-item">
                        <label for="job-descricao" class="form-label">Descrição</label>
                        <textarea id="job-descricao" class="form-textarea" placeholder="Digite a descrição" required></textarea>
                        <div id="descricao-error" class="form-error"></div>
                    </div>
                    <div class="dialog-footer">
                        <button type="button" id="cancel-button" class="button button-outline">Cancelar</button>
                        <button type="submit" id="submit-button" class="button">Adicionar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Delete Confirmation Dialog -->
        <div id="delete-dialog" class="dialog-backdrop" style="display: none;">
            <div class="dialog alert-dialog-content">
                <div class="alert-dialog-header">
                    <h3 class="alert-dialog-title">Confirmar exclusão</h3>
                    <p class="alert-dialog-description">
                        Esta ação não pode ser desfeita. O cargo será permanentemente removido do sistema.
                    </p>
                </div>
                <div class="alert-dialog-footer">
                    <button id="delete-cancel" class="button button-outline">Cancelar</button>
                    <button id="delete-confirm" class="button destructive-button">Excluir</button>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div id="toast-container" class="toast-container"></div>
    </div>

    <script>
        // API URL
        const API_URL = "https://script.google.com/macros/s/AKfycbzB5yA3_vmLErBwwC0uHPQzWJPw16DEiG_xBZjVYa2-owVSGsxI1PVVIDoJ-RKYPTaR/exec";
        
        // Global state
        let allJobs = [];
        let filteredJobs = [];
        let jobToDeleteId = null;
        
        // DOM Elements
        const contentContainer = document.getElementById('content-container');
        const totalCountElement = document.getElementById('total-count');
        const searchInput = document.getElementById('search-input');
        const searchClear = document.getElementById('search-clear');
        const addButton = document.getElementById('add-button');
        const jobFormDialog = document.getElementById('job-form-dialog');
        const jobForm = document.getElementById('job-form');
        const jobIdInput = document.getElementById('job-id');
        const categoriaInput = document.getElementById('job-categoria');
        const tituloInput = document.getElementById('job-titulo');
        const descricaoInput = document.getElementById('job-descricao');
        const dialogTitle = document.getElementById('dialog-title');
        const submitButton = document.getElementById('submit-button');
        const cancelButton = document.getElementById('cancel-button');
        const deleteDialog = document.getElementById('delete-dialog');
        const deleteCancel = document.getElementById('delete-cancel');
        const deleteConfirm = document.getElementById('delete-confirm');
        const themeToggle = document.getElementById('theme-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        const toastContainer = document.getElementById('toast-container');
        const header = document.querySelector('.header');

        // Theme Management
        function initTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.classList.toggle('dark', savedTheme === 'dark');
            updateThemeIcon(savedTheme);
        }

        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'block';
            } else {
                moonIcon.style.display = 'block';
                sunIcon.style.display = 'none';
            }
        }

        function toggleTheme() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateThemeIcon(isDark ? 'dark' : 'light');
        }

        // Toast notification system
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const iconSvg = type === 'success' 
                ? '<svg class="toast-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>'
                : '<svg class="toast-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>';
            
            toast.innerHTML = `
                ${iconSvg}
                <div class="toast-content">${message}</div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        // Fetch and process jobs
        async function fetchJobs() {
            try {
                contentContainer.innerHTML = `
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                `;
                
                const response = await fetch(`${API_URL}?action=read`);
                const text = await response.text();
                
                // Parse CSV data
                const lines = text.trim().split("\n").slice(1);
                const jobs = [];
                
                lines.forEach(line => {
                    const parts = line.split(", ");
                    const id = parts[0];
                    const categoria = parts[1];
                    const titulo = parts[2];
                    const descricao = parts.slice(3).join(", "); // Handle commas in description
                    
                    jobs.push({ id, categoria, titulo, descricao });
                });
                
                allJobs = jobs;
                filteredJobs = jobs;
                organizeAndDisplayJobs(jobs);
                
                return jobs;
            } catch (error) {
                console.error('Error fetching jobs:', error);
                contentContainer.innerHTML = `
                    <div class="empty-state">
                        <h3 class="empty-title">Erro ao carregar dados</h3>
                        <p class="empty-message">Tente novamente mais tarde.</p>
                    </div>
                `;
                showToast('Falha ao carregar dados', 'error');
                return [];
            }
        }

        // Organize jobs by category and display them
        function organizeAndDisplayJobs(jobs) {
            if (jobs.length === 0) {
                contentContainer.innerHTML = `
                    <div class="empty-state">
                        <h3 class="empty-title">Nenhum resultado encontrado</h3>
                        <p class="empty-message">
                            ${searchInput.value 
                                ? 'Tente ajustar sua pesquisa' 
                                : 'Adicione seu primeiro cargo clicando no botão "Adicionar"'}
                        </p>
                    </div>
                `;
                totalCountElement.textContent = '0';
                return;
            }
            
            // Update total count
            totalCountElement.textContent = jobs.length;
            
            // Organize by category
            const categorized = {};
            
            jobs.forEach(job => {
                if (!categorized[job.categoria]) {
                    categorized[job.categoria] = [];
                }
                categorized[job.categoria].push(job);
            });
            
            // Build HTML for each category
            let html = '';
            
            Object.entries(categorized).forEach(([category, categoryJobs]) => {
                const randomDelay = Math.random() * 0.3;
                
                html += `
                    <section class="category-section" style="animation-delay: ${randomDelay}s">
                        <div class="category-header">
                            <div class="category-badge">${category}</div>
                            <div class="category-count">
                                ${categoryJobs.length} ${categoryJobs.length === 1 ? 'cargo' : 'cargos'}
                            </div>
                            <div class="category-divider"></div>
                        </div>
                        
                        <div class="card-grid">
                            ${categoryJobs.map(job => createJobCard(job)).join('')}
                        </div>
                    </section>
                `;
            });
            
            contentContainer.innerHTML = html;
        }

        // Create HTML for a job card
        function createJobCard(job) {
            return `
                <div class="card">
                    <div class="card-content">
                        <h3 class="card-title">${job.titulo}</h3>
                        <p class="card-description">${job.descricao}</p>
                    </div>
                    
                    <div class="card-footer">
                        <div class="tooltip">
                            <button class="icon-button" onclick="editJob('${job.id}', '${job.categoria}', '${job.titulo.replace(/'/g, "\\'")}', \`${job.descricao.replace(/`/g, "\\`")}\`)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path>
                                    <path d="m15 5 4 4"></path>
                                </svg>
                                <span class="sr-only">Editar</span>
                            </button>
                            <div class="tooltip-content">Editar</div>
                        </div>
                        
                        <div class="tooltip">
                            <button class="icon-button delete" onclick="confirmDelete('${job.id}')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M3 6h18"></path>
                                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                                </svg>
                                <span class="sr-only">Excluir</span>
                            </button>
                            <div class="tooltip-content">Excluir</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Search functionality
        function handleSearch() {
            const searchTerm = searchInput.value.toLowerCase();
            
            // Show/hide clear button
            searchClear.style.display = searchTerm ? 'block' : 'none';
            
            if (searchTerm) {
                filteredJobs = allJobs.filter(job => 
                    job.titulo.toLowerCase().includes(searchTerm) || 
                    job.descricao.toLowerCase().includes(searchTerm)
                );
            } else {
                filteredJobs = allJobs;
            }
            
            organizeAndDisplayJobs(filteredJobs);
        }

        // Clear search
        function clearSearch() {
            searchInput.value = '';
            searchClear.style.display = 'none';
            filteredJobs = allJobs;
            organizeAndDisplayJobs(filteredJobs);
            searchInput.focus();
        }

        // Form handling
        function openJobForm(isEdit = false, job = null) {
            if (isEdit && job) {
                jobIdInput.value = job.id || '';
                categoriaInput.value = job.categoria || '';
                tituloInput.value = job.titulo || '';
                descricaoInput.value = job.descricao || '';
                
                dialogTitle.textContent = 'Editar Cargo';
                submitButton.textContent = 'Atualizar';
            } else {
                jobForm.reset();
                jobIdInput.value = '';
                
                dialogTitle.textContent = 'Adicionar Cargo';
                submitButton.textContent = 'Adicionar';
            }
            
            // Clear any previous errors
            document.querySelectorAll('.form-error').forEach(el => el.textContent = '');
            
            // Show dialog
            jobFormDialog.style.display = 'flex';
            
            // Focus first field after a short delay
            setTimeout(() => {
                if (isEdit && job) {
                    tituloInput.focus();
                } else {
                    categoriaInput.focus();
                }
            }, 100);
        }

        function closeJobForm() {
            jobFormDialog.style.display = 'none';
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            
            // Basic validation
            let hasError = false;
            
            if (!categoriaInput.value.trim()) {
                document.getElementById('categoria-error').textContent = 'Categoria é obrigatória';
                hasError = true;
            }
            
            if (!tituloInput.value.trim()) {
                document.getElementById('titulo-error').textContent = 'Título é obrigatório';
                hasError = true;
            }
            
            if (!descricaoInput.value.trim()) {
                document.getElementById('descricao-error').textContent = 'Descrição é obrigatória';
                hasError = true;
            }
            
            if (hasError) return;
            
            // Get form values
            const id = jobIdInput.value;
            const categoria = categoriaInput.value.trim();
            const titulo = tituloInput.value.trim();
            const descricao = descricaoInput.value.trim();
            
            try {
                if (id) {
                    // Update existing job
                    await updateJob(id, categoria, titulo, descricao);
                } else {
                    // Create new job
                    await createJob(categoria, titulo, descricao);
                }
                
                closeJobForm();
                await fetchJobs();
            } catch (error) {
                console.error('Error submitting form:', error);
                showToast(id ? 'Falha ao atualizar registro' : 'Falha ao adicionar registro', 'error');
            }
        }

        async function createJob(categoria, titulo, descricao) {
            try {
                const id = Date.now().toString();
                const formData = new URLSearchParams({
                    action: 'create',
                    id,
                    categoria,
                    titulo,
                    descricao
                });
                
                await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });
                
                showToast('Registro adicionado com sucesso');
                return true;
            } catch (error) {
                console.error('Error creating job:', error);
                showToast('Falha ao adicionar registro', 'error');
                throw error;
            }
        }

        async function updateJob(id, categoria, titulo, descricao) {
            try {
                const formData = new URLSearchParams({
                    action: 'update',
                    id,
                    categoria,
                    titulo,
                    descricao
                });
                
                await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });
                
                showToast('Registro atualizado com sucesso');
                return true;
            } catch (error) {
                console.error('Error updating job:', error);
                showToast('Falha ao atualizar registro', 'error');
                throw error;
            }
        }

        // Edit job
        function editJob(id, categoria, titulo, descricao) {
            openJobForm(true, { id, categoria, titulo, descricao });
        }

        // Delete handling
        function confirmDelete(id) {
            jobToDeleteId = id;
            deleteDialog.style.display = 'flex';
        }

        function closeDeleteDialog() {
            deleteDialog.style.display = 'none';
            jobToDeleteId = null;
        }

        async function handleDelete() {
            if (!jobToDeleteId) return;
            
            try {
                const formData = new URLSearchParams({
                    action: 'delete',
                    id: jobToDeleteId
                });
                
                await fetch(API_URL, {
                    method: 'POST',
                    body: formData
                });
                
                showToast('Registro excluído com sucesso');
                closeDeleteDialog();
                await fetchJobs();
            } catch (error) {
                console.error('Error deleting job:', error);
                showToast('Falha ao excluir registro', 'error');
            }
        }

        // Scroll handling for header
        function handleScroll() {
            if (window.scrollY > 10) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        }

        // Handle keyboard shortcuts
        function handleKeyDown(e) {
            // Cmd+K or Ctrl+K to focus search
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                searchInput.focus();
            }
            
            // Escape to close dialogs
            if (e.key === 'Escape') {
                if (jobFormDialog.style.display === 'flex') {
                    closeJobForm();
                }
                
                if (deleteDialog.style.display === 'flex') {
                    closeDeleteDialog();
                }
                
                if (document.activeElement === searchInput) {
                    clearSearch();
                }
            }
        }

        // Initialize
        function init() {
            // Load theme
            initTheme();
            
            // Fetch jobs
            fetchJobs();
            
            // Add event listeners
            searchInput.addEventListener('input', handleSearch);
            searchClear.addEventListener('click', clearSearch);
            addButton.addEventListener('click', () => openJobForm());
            cancelButton.addEventListener('click', closeJobForm);
            jobForm.addEventListener('submit', handleFormSubmit);
            deleteCancel.addEventListener('click', closeDeleteDialog);
            deleteConfirm.addEventListener('click', handleDelete);
            themeToggle.addEventListener('click', toggleTheme);
            window.addEventListener('scroll', handleScroll);
            window.addEventListener('keydown', handleKeyDown);
            
            // Global functions
            window.editJob = editJob;
            window.confirmDelete = confirmDelete;
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
