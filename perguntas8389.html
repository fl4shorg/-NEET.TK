
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Anon Inbox Zen</title>
  <meta name="description" content="Anonymous messaging inbox application" />
  <meta name="author" content="Lovable" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap">

  <meta property="og:title" content="Anon Inbox Zen" />
  <meta property="og:description" content="Anonymous messaging inbox application" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:site" content="@lovable_dev" />
  <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
  <style>
    /* Base Styles */
    :root {
      --background: 0 0% 100%;
      --foreground: 222.2 84% 4.9%;
      --card: 0 0% 100%;
      --card-foreground: 222.2 84% 4.9%;
      --popover: 0 0% 100%;
      --popover-foreground: 222.2 84% 4.9%;
      --primary: 222.2 47.4% 11.2%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96.1%;
      --secondary-foreground: 222.2 47.4% 11.2%;
      --muted: 210 40% 96.1%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 210 40% 96.1%;
      --accent-foreground: 222.2 47.4% 11.2%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 40% 98%;
      --border: 214.3 31.8% 91.4%;
      --input: 214.3 31.8% 91.4%;
      --ring: 222.2 84% 4.9%;
      --radius: 0.5rem;

      /* Gradient variables */
      --gradient-purple-from: 271 91% 65%;
      --gradient-purple-to: 262 83% 58%;
      --gradient-blue-from: 217 91% 60%;
      --gradient-blue-to: 199 89% 48%;
      --gradient-pink-from: 336 80% 58%;
      --gradient-pink-to: 345 83% 41%;
      --gradient-green-from: 142 71% 45%;
      --gradient-green-to: 160 84% 39%;
      --gradient-orange-from: 27 96% 61%;
      --gradient-orange-to: 43 96% 50%;
    }

    .dark {
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --card: 222.2 84% 4.9%;
      --card-foreground: 210 40% 98%;
      --popover: 222.2 84% 4.9%;
      --popover-foreground: 210 40% 98%;
      --primary: 210 40% 98%;
      --primary-foreground: 222.2 47.4% 11.2%;
      --secondary: 217.2 32.6% 17.5%;
      --secondary-foreground: 210 40% 98%;
      --muted: 217.2 32.6% 17.5%;
      --muted-foreground: 215 20.2% 65.1%;
      --accent: 217.2 32.6% 17.5%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 40% 98%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
      --ring: 212.7 26.8% 83.9%;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      background-color: hsl(var(--background));
      color: hsl(var(--foreground));
      transition: background-color 0.3s, color 0.3s;
    }

    .app {
      max-width: 430px;
      margin: 0 auto;
      min-height: 100vh;
      position: relative;
      background-color: white;
    }

    .dark .app {
      background-color: #1a1a1a;
    }

    /* Header Styles */
    header {
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      padding: 1rem 0;
      border-bottom: 1px solid #e5e5e5;
    }

    .dark header {
      border-bottom-color: #333;
    }

    header h2 {
      font-weight: 800;
      font-size: 1.25rem;
      text-align: center;
      color: #111827;
    }

    .dark header h2 {
      color: white;
    }

    header .left-button, header .right-buttons {
      position: absolute;
      display: flex;
      align-items: center;
    }

    header .left-button {
      left: 1.5rem;
    }

    header .right-buttons {
      right: 1.5rem;
      gap: 0.75rem;
    }

    .gradient-circle {
      border-radius: 50%;
      width: 2rem;
      height: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .gradient-purple {
      background-image: linear-gradient(to right, hsl(var(--gradient-purple-from)), hsl(var(--gradient-purple-to)));
    }

    .gradient-blue {
      background-image: linear-gradient(to right, hsl(var(--gradient-blue-from)), hsl(var(--gradient-blue-to)));
    }

    .gradient-pink {
      background-image: linear-gradient(to right, hsl(var(--gradient-pink-from)), hsl(var(--gradient-pink-to)));
    }

    .gradient-green {
      background-image: linear-gradient(to right, hsl(var(--gradient-green-from)), hsl(var(--gradient-green-to)));
    }

    .gradient-orange {
      background-image: linear-gradient(to right, hsl(var(--gradient-orange-from)), hsl(var(--gradient-orange-to)));
    }

    .icon-button {
      background-color: #f3f4f6;
      border-radius: 50%;
      width: 2.5rem;
      height: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #6b7280;
      transition: background-color 0.2s;
    }

    .dark .icon-button {
      background-color: #333;
      color: #d1d5db;
    }

    .icon-button:hover {
      background-color: #e5e7eb;
    }

    .dark .icon-button:hover {
      background-color: #444;
    }

    /* Main Content */
    main {
      padding: 1.5rem;
      padding-bottom: 5rem;
      min-height: calc(100vh - 4rem);
    }

    /* Message Item */
    .message-item {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      padding: 0.75rem 1rem;
      border-radius: 9999px;
      transition: all 0.2s;
      border: 1px solid transparent;
      margin-bottom: 0.5rem;
      cursor: pointer;
    }

    .message-item:hover {
      background-color: #f3f4f6;
    }

    .dark .message-item:hover {
      background-color: #333;
    }

    .message-item.active {
      background-color: #f87171; /* red-400 */
      color: white;
      border-color: #ef4444; /* red-500 */
    }

    .dark .message-item.active {
      background-color: #b91c1c; /* red-700 */
      border-color: #dc2626; /* red-600 */
    }

    .message-item .avatar {
      background-color: #f3f4f6;
      border-radius: 50%;
      padding: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .dark .message-item .avatar {
      background-color: #333;
    }

    .message-item img {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      object-fit: cover;
    }

    .message-item .text-group {
      flex-grow: 1;
      overflow: hidden;
    }

    .message-item .title {
      font-weight: 700;
      font-size: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .message-item .subtitle {
      font-size: 0.875rem;
      color: #6b7280;
    }

    .dark .message-item .subtitle {
      color: #9ca3af;
    }

    .message-item.active .subtitle {
      color: rgba(255, 255, 255, 0.8);
    }

    .message-item .chevron {
      color: #d1d5db;
    }

    .message-item.active .chevron {
      color: rgba(255, 255, 255, 0.8);
    }

    /* Message Card */
    .message-card {
      background-color: white;
      border-radius: 1rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin-top: 1rem;
      overflow: hidden;
      border: 1px solid #e5e5e5;
      animation: slideDown 0.3s ease-out;
      user-select: none;
    }

    .dark .message-card {
      background-color: #1f2937;
      border-color: #374151;
    }

    @keyframes slideDown {
      from {
        transform: translateY(-10px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .message-header {
      background: linear-gradient(90deg, #7c3aed 0%, #2563eb 100%);
      color: white;
      font-weight: 700;
      font-size: 1.25rem;
      padding: 1rem;
      text-align: center;
      line-height: 1.2;
      user-select: text;
    }

    .message-content {
      padding: 1.5rem;
      text-align: center;
      font-size: 1.25rem;
      font-weight: 600;
      color: #111827;
      line-height: 1.4;
      user-select: text;
    }

    .dark .message-content {
      color: #f9fafb;
    }

    .message-actions {
      display: flex;
      justify-content: center;
      gap: 1rem;
      padding: 1rem;
    }

    .action-button {
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
      cursor: pointer;
      border: none;
      color: white;
      outline-offset: 2px;
    }

    .action-button:hover {
      transform: scale(1.05);
    }

    .action-button:focus-visible {
      outline: 2px solid #8B5CF6;
      outline-offset: 2px;
    }

    .action-button.info {
      background: linear-gradient(90deg, #8B5CF6 0%, #3B82F6 100%);
    }

    .action-button.share {
      background-color: #22c55e;
    }

    .action-button.arrow {
      background-color: #374151;
      color: #d1d5db;
    }

    .action-button.gray {
      background-color: #6b7280;
    }

    /* Bottom Navigation */
    .bottom-nav {
      background-color: white;
      border-top: 1px solid #e5e5e5;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      max-width: 430px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 2.5rem;
      border-top-left-radius: 1.5rem;
      border-top-right-radius: 1.5rem;
      margin: 0 auto;
      z-index: 10;
    }

    .dark .bottom-nav {
      background-color: #333;
      border-top-color: #444;
    }

    .nav-button {
      color: #6b7280;
      font-size: 1.5rem;
      padding: 0.5rem;
      border-radius: 0.5rem;
      transition: all 0.2s;
      border: none;
      background: transparent;
      cursor: pointer;
      position: relative;
    }

    .dark .nav-button {
      color: #9ca3af;
    }

    .nav-button.active-underline {
      position: relative;
    }

    .nav-button.active-underline::after {
      content: "";
      position: absolute;
      bottom: -6px;
      left: 0;
      right: 0;
      height: 3px;
      border-radius: 9999px;
    }

    .btn-gradient {
      color: white;
      padding: 1rem;
      border-radius: 50%;
      margin-top: -2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: box-shadow 0.2s;
      border: none;
      cursor: pointer;
    }

    .btn-gradient:hover {
      box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
    }

    .btn-secondary {
      background-color: #f3f4f6;
      color: #6b7280;
    }

    .dark .btn-secondary {
      background-color: #333;
      color: #d1d5db;
    }

    /* Settings Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
    }

    .modal-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .modal-content {
      background-color: white;
      border-radius: 1rem;
      padding: 1.5rem;
      width: 90%;
      max-width: 400px;
      transform: scale(0.95);
      transition: transform 0.2s;
    }

    .dark .modal-content {
      background-color: #222;
    }

    .modal-overlay.active .modal-content {
      transform: scale(1);
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
    }

    .modal-header h3 {
      font-size: 1.25rem;
      font-weight: 600;
      color: #111827;
    }

    .dark .modal-header h3 {
      color: #f9fafb;
    }

    .close-button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      color: #6b7280;
    }

    .dark .close-button {
      color: #9ca3af;
    }

    /* Theme Settings */
    .theme-setting {
      margin-bottom: 1.5rem;
    }

    .theme-setting h4 {
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: #111827;
    }

    .dark .theme-setting h4 {
      color: #f9fafb;
    }

    .theme-toggle {
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      border: 1px solid #e5e7eb;
      cursor: pointer;
      background-color: #f3f4f6;
      color: #111827;
    }

    .dark .theme-toggle {
      background-color: #333;
      color: #f9fafb;
      border-color: #444;
    }

    .theme-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.5rem;
    }

    .theme-button {
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
      color: white;
      font-weight: 500;
      border: none;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .theme-button.active {
      outline: 2px solid white;
      outline-offset: 2px;
    }

    .theme-button:hover {
      transform: scale(1.05);
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.5rem;
      margin-top: 2rem;
    }

    .pagination button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 0.5rem;
      border: 1px solid #e5e7eb;
      background-color: white;
      color: #6b7280;
      cursor: pointer;
      transition: all 0.2s;
    }

    .dark .pagination button {
      background-color: #333;
      border-color: #444;
      color: #d1d5db;
    }

    .pagination button:hover:not(:disabled) {
      background-color: #f3f4f6;
      border-color: #d1d5db;
    }

    .dark .pagination button:hover:not(:disabled) {
      background-color: #444;
      border-color: #555;
    }

    .pagination button.active {
      background-color: #f3f4f6;
      color: #111827;
      font-weight: 600;
    }

    .dark .pagination button.active {
      background-color: #444;
      color: white;
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Loading skeletons */
    .skeleton {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      background-color: #e5e7eb;
      border-radius: 0.375rem;
    }

    .dark .skeleton {
      background-color: #374151;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: .5;
      }
    }

    .skeleton-item {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      align-items: center;
    }

    .skeleton-circle {
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
    }

    .skeleton-line {
      height: 1rem;
      width: 100%;
    }

    .skeleton-line-short {
      width: 60%;
      margin-top: 0.5rem;
    }

    .scroll-area {
      overflow-y: auto;
      max-height: calc(100vh - 14rem);
      padding-right: 0.5rem;
    }

    .scroll-area::-webkit-scrollbar {
      width: 0.5rem;
    }

    .scroll-area::-webkit-scrollbar-track {
      background: transparent;
    }

    .scroll-area::-webkit-scrollbar-thumb {
      background-color: #d1d5db;
      border-radius: 9999px;
    }

    .dark .scroll-area::-webkit-scrollbar-thumb {
      background-color: #4b5563;
    }

    .no-messages {
      text-align: center;
      padding: 2.5rem 0;
      color: #6b7280;
    }

    .dark .no-messages {
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div id="app" class="app"></div>

  <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
  <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
  
  <script>
    // Main application state
    const state = {
      currentView: 'inbox', // inbox, messages, profile
      theme: localStorage.getItem('theme') || 'light', // light, dark
      gradientTheme: localStorage.getItem('gradientTheme') || 'purple', // purple, blue, pink, green, orange
      messages: [],
      expandedIndex: null,
      loading: true,
      showSettingsModal: false,
      currentPage: 1,
      totalPages: 1,
      pageSize: 10
    };

    // Gradient themes configuration
    const gradientThemes = [
      { name: "purple", displayName: "Purple" },
      { name: "blue", displayName: "Blue" },
      { name: "pink", displayName: "Pink" },
      { name: "green", displayName: "Green" },
      { name: "orange", displayName: "Orange" }
    ];

    // Apply initial theme
    document.body.classList.toggle('dark', state.theme === 'dark');

    // Time formatter utility
    function timeAgo(date) {
      const now = new Date();
      const past = new Date(date);
      const diffInSeconds = Math.floor((now - past) / 1000);

      if (diffInSeconds < 60) {
        return 'Agora mesmo';
      } else if (diffInSeconds < 3600) {
        const minutes = Math.floor(diffInSeconds / 60);
        return `${minutes} ${minutes === 1 ? 'minuto' : 'minutos'} atrás`;
      } else if (diffInSeconds < 86400) {
        const hours = Math.floor(diffInSeconds / 3600);
        return `${hours} ${hours === 1 ? 'hora' : 'horas'} atrás`;
      } else if (diffInSeconds < 604800) {
        const days = Math.floor(diffInSeconds / 86400);
        return `${days} ${days === 1 ? 'dia' : 'dias'} atrás`;
      } else {
        const options = { day: 'numeric', month: 'short' };
        return past.toLocaleDateString('pt-BR', options);
      }
    }

    // Fetch messages from API with pagination
    async function fetchMessages(page = 1, pageSize = 10) {
      try {
        state.loading = true;
        renderApp();
        
        const res = await fetch('https://script.google.com/macros/s/AKfycbyMh9YnzKtxF9Nc_awc9w8KSPyXa4OzXf0iiW748b8-dY4W0SxkoYy77Wcudn7ky9xUJg/exec');
        
        if (!res.ok) throw new Error('Failed to fetch messages');
        
        const data = await res.json();
        
        // Process all messages
        const allMessages = data.perguntas ? data.perguntas.reverse().map((msg, index) => ({
          ...msg,
          id: `msg-${index}`
        })) : [];
        
        // Calculate pagination
        const totalCount = allMessages.length;
        state.totalPages = Math.ceil(totalCount / pageSize);
        
        // Get current page messages
        const startIndex = (page - 1) * pageSize;
        const endIndex = startIndex + pageSize;
        
        return allMessages.slice(startIndex, endIndex);
      } catch (error) {
        console.error('Error fetching messages:', error);
        alert("Erro ao carregar mensagens. Tente novamente mais tarde.");
        return [];
      } finally {
        state.loading = false;
      }
    }

    // Toggle theme between light and dark
    function toggleTheme() {
      state.theme = state.theme === 'dark' ? 'light' : 'dark';
      document.body.classList.toggle('dark', state.theme === 'dark');
      localStorage.setItem('theme', state.theme);
      renderApp();
    }

    // Set gradient theme
    function setGradientTheme(themeName) {
      state.gradientTheme = themeName;
      localStorage.setItem('gradientTheme', themeName);
      state.showSettingsModal = false;
      renderApp();
    }

    // Toggle settings modal visibility
    function toggleSettingsModal() {
      state.showSettingsModal = !state.showSettingsModal;
      renderApp();
    }

    // Navigate between views
    function navigate(view) {
      state.currentView = view;
      state.expandedIndex = null;
      renderApp();
    }

    // Toggle message expansion
    function toggleExpand(index) {
      state.expandedIndex = state.expandedIndex === index ? null : index;
      renderApp();
    }

    // Change page
    function changePage(newPage) {
      if (newPage >= 1 && newPage <= state.totalPages) {
        state.currentPage = newPage;
        state.expandedIndex = null;
        loadMessages();
      }
    }

    // Initial app load
    async function loadApp() {
      await loadMessages();
    }

    // Load messages for current page
    async function loadMessages() {
      state.loading = true;
      renderApp();
      state.messages = await fetchMessages(state.currentPage, state.pageSize);
      state.loading = false;
      renderApp();
    }

    // Render the message item
    function renderMessageItem(message, index) {
      const isActive = state.expandedIndex === index;
      const timeText = timeAgo(message.data);
      const avatarUrl = 'https://storage.googleapis.com/a1aa/image/e40343bf-df76-4d75-b5e8-5c994ba061d0.jpg';
      
      return `
        <div class="message-item ${isActive ? 'active' : ''}" 
            onclick="toggleExpand(${index})">
          <div class="avatar">
            <img src="${avatarUrl}" alt="Avatar">
          </div>
          <div class="text-group">
            <div class="title">
              ${message.pergunta.length > 20 ? message.pergunta.slice(0, 20) + '...' : message.pergunta}
            </div>
            <div class="subtitle">
              ${timeText}
            </div>
          </div>
          <div class="chevron">
            ${isActive ? 
              '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 15 6-6 6 6"/></svg>' : 
              '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 6 6 6-6 6"/></svg>'
            }
          </div>
        </div>
      `;
    }

    // Render the message card
    function renderMessageCard(message) {
      return `
        <div class="message-card">
          <div class="message-header">me mande mensagens anônimas!</div>
          <div class="message-content">${message.pergunta}</div>
          <div class="message-actions">
            <button class="action-button info" title="Info">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="13.5" cy="6.5" r=".5" fill="currentColor"/>
                <circle cx="17.5" cy="10.5" r=".5" fill="currentColor"/>
                <circle cx="8.5" cy="7.5" r=".5" fill="currentColor"/>
                <circle cx="6.5" cy="12.5" r=".5" fill="currentColor"/>
                <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"/>
              </svg>
            </button>
            <button class="action-button share" title="Compartilhar">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z"/>
                <circle cx="12" cy="12" r="10"/>
              </svg>
            </button>
            <button class="action-button arrow" title="Seta">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" class="text-green-500">
                <path d="M12 22v-4"/>
                <path d="M7 12c-1.5 0-4.5 1.5-5 3 3.5 1.5 6 1 6 1-1.5 1.5-2 3.5-2 5 2.5 0 4.5-1.5 6-3 1.5 1.5 3.5 3 6 3 0-1.5-.5-3.5-2-5 0 0 2.5.5 6-1-.5-1.5-3.5-3-5-3 1.5-1 4-4 4-6-2.5 0-5.5 1.5-7 3 0-2.5-.5-5-2-7-1.5 2-2 4.5-2 7-1.5-1.5-4.5-3-7-3 0 2 2.5 5 4 6"/>
              </svg>
            </button>
            <button class="action-button gray" title="Outros">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2"/>
                <path d="M6.453 15h11.094"/>
                <path d="M8.5 2h7"/>
              </svg>
            </button>
          </div>
        </div>
      `;
    }

    // Render loading skeletons
    function renderSkeletons(count = 5) {
      let skeletons = '';
      for (let i = 0; i < count; i++) {
        skeletons += `
          <div class="skeleton-item">
            <div class="skeleton skeleton-circle"></div>
            <div style="flex-grow: 1;">
              <div class="skeleton skeleton-line" style="max-width: 14rem;"></div>
              <div class="skeleton skeleton-line skeleton-line-short" style="max-width: 8rem;"></div>
            </div>
          </div>
        `;
      }
      return skeletons;
    }

    // Render pagination
    function renderPagination() {
      if (state.totalPages <= 1) return '';
      
      let pagination = '<div class="pagination">';
      
      // Previous button
      pagination += `
        <button 
          ${state.currentPage <= 1 ? 'disabled' : ''} 
          onclick="changePage(${state.currentPage - 1})"
          aria-label="Previous page"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
      `;
      
      // Page numbers
      for (let i = 1; i <= state.totalPages; i++) {
        // Show only relevant page numbers to avoid cluttering the UI
        if (
          i === 1 || 
          i === state.totalPages || 
          (i >= state.currentPage - 1 && i <= state.currentPage + 1)
        ) {
          pagination += `
            <button 
              class="${state.currentPage === i ? 'active' : ''}"
              onclick="changePage(${i})"
              aria-label="Page ${i}"
            >
              ${i}
            </button>
          `;
        } else if (
          (i === 2 && state.currentPage > 3) ||
          (i === state.totalPages - 1 && state.currentPage < state.totalPages - 2)
        ) {
          pagination += '<span>...</span>';
        }
      }
      
      // Next button
      pagination += `
        <button 
          ${state.currentPage >= state.totalPages ? 'disabled' : ''} 
          onclick="changePage(${state.currentPage + 1})"
          aria-label="Next page"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </button>
      `;
      
      pagination += '</div>';
      return pagination;
    }

    // Render the inbox view
    function renderInbox() {
      let content = '';
      
      if (state.loading) {
        content = renderSkeletons(5);
      } else if (state.messages.length === 0) {
        content = '<p class="no-messages">Nenhuma mensagem encontrada.</p>';
      } else {
        content = `<div class="scroll-area">`;
        content += state.messages.map((message, index) => {
          let output = renderMessageItem(message, index);
          if (state.expandedIndex === index) {
            output += renderMessageCard(message);
          }
          return output;
        }).join('');
        content += `</div>`;
        content += renderPagination();
      }

      return `
        <header>
          <div class="left-button gradient-circle gradient-${state.gradientTheme}">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-6l-2 3h-4l-2-3H2"/><path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>
          </div>
          <h2>INBOX</h2>
          <div class="right-buttons">
            <button class="icon-button" onclick="toggleTheme()" aria-label="Toggle theme">
              ${state.theme === 'dark' ? 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>' : 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>'
              }
            </button>
            <button class="icon-button" onclick="toggleSettingsModal()" aria-label="Settings">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
        </header>
        <main>${content}</main>
      `;
    }

    // Render the messages view
    function renderMessages() {
      let content = '';
      
      if (state.loading) {
        content = `
          <div class="space-y-6">
            ${[...Array(3)].map(() => `
              <div style="margin-bottom: 1.5rem;">
                <div class="skeleton" style="height: 2rem; width: 100%; margin-bottom: 0.75rem;"></div>
                <div class="skeleton" style="height: 6rem; width: 100%; border-radius: 0.5rem; margin-bottom: 0.75rem;"></div>
                <div style="display: flex; justify-content: center; gap: 1rem;">
                  <div class="skeleton" style="height: 2.5rem; width: 2.5rem; border-radius: 9999px;"></div>
                  <div class="skeleton" style="height: 2.5rem; width: 2.5rem; border-radius: 9999px;"></div>
                  <div class="skeleton" style="height: 2.5rem; width: 2.5rem; border-radius: 9999px;"></div>
                </div>
              </div>
            `).join('')}
          </div>
        `;
      } else if (state.messages.length === 0) {
        content = '<p class="no-messages">Nenhuma mensagem encontrada.</p>';
      } else {
        content = `<div class="scroll-area">`;
        content += state.messages.map((message) => renderMessageCard(message)).join('');
        content += `</div>`;
        content += renderPagination();
      }

      return `
        <header>
          <div class="left-button gradient-circle gradient-${state.gradientTheme}">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          </div>
          <h2>MENSAGENS</h2>
          <div class="right-buttons">
            <button class="icon-button" onclick="toggleTheme()" aria-label="Toggle theme">
              ${state.theme === 'dark' ? 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>' : 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>'
              }
            </button>
            <button class="icon-button" onclick="toggleSettingsModal()" aria-label="Settings">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
        </header>
        <main>${content}</main>
      `;
    }

    // Render the profile view
    function renderProfile() {
      return `
        <header>
          <div class="left-button gradient-circle gradient-${state.gradientTheme}">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
          </div>
          <h2>PERFIL</h2>
          <div class="right-buttons">
            <button class="icon-button" onclick="toggleTheme()" aria-label="Toggle theme">
              ${state.theme === 'dark' ? 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>' : 
                '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>'
              }
            </button>
            <button class="icon-button" onclick="toggleSettingsModal()" aria-label="Settings">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
            </button>
          </div>
        </header>
        <main>
          <div style="text-align: center; padding: 5rem 1rem;">
            <h2 style="margin-bottom: 1rem; font-size: 1.5rem; font-weight: 600; color: ${state.theme === 'dark' ? '#f3f4f6' : '#111827'}">Perfil</h2>
            <p style="color: ${state.theme === 'dark' ? '#9ca3af' : '#6b7280'}">Conteúdo do perfil virá aqui.</p>
          </div>
        </main>
      `;
    }

    // Render the bottom navigation
    function renderBottomNav() {
      const messagesUnderline = state.currentView === 'messages' 
        ? `<span style="position: absolute; bottom: -6px; left: 0; right: 0; height: 3px; border-radius: 9999px; background-image: linear-gradient(to right, hsl(var(--gradient-${state.gradientTheme}-from)), hsl(var(--gradient-${state.gradientTheme}-to)));"></span>` 
        : '';
      
      const profileUnderline = state.currentView === 'profile'
        ? `<span style="position: absolute; bottom: -6px; left: 0; right: 0; height: 3px; border-radius: 9999px; background-image: linear-gradient(to right, hsl(var(--gradient-${state.gradientTheme}-from)), hsl(var(--gradient-${state.gradientTheme}-to)));"></span>`
        : '';

      return `
        <nav class="bottom-nav">
          <button 
            class="nav-button ${state.currentView === 'messages' ? 'active-underline' : ''}"
            onclick="navigate('messages')" 
            aria-label="Messages"
            style="position: relative;"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            </svg>
            ${messagesUnderline}
          </button>
          
          <button 
            class="${state.currentView === 'inbox' 
              ? `btn-gradient gradient-${state.gradientTheme}` 
              : 'btn-gradient btn-secondary'}"
            onclick="navigate('inbox')" 
            aria-label="Inbox"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 12h-6l-2 3h-4l-2-3H2"/>
              <path d="M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/>
            </svg>
          </button>
          
          <button 
            class="nav-button ${state.currentView === 'profile' ? 'active-underline' : ''}"
            onclick="navigate('profile')" 
            aria-label="Profile"
            style="position: relative;"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
              <circle cx="12" cy="7" r="4"/>
            </svg>
            ${profileUnderline}
          </button>
        </nav>
      `;
    }

    // Render settings modal
    function renderSettingsModal() {
      if (!state.showSettingsModal) return '';
      
      return `
        <div class="modal-overlay active">
          <div class="modal-content">
            <div class="modal-header">
              <h3>Settings</h3>
              <button class="close-button" onclick="toggleSettingsModal()">&times;</button>
            </div>
            <div>
              <div class="theme-setting">
                <h4>Theme</h4>
                <button 
                  class="theme-toggle"
                  onclick="toggleTheme()"
                >
                  ${state.theme === 'light' ? 'Light Mode' : 'Dark Mode'}
                </button>
              </div>
              
              <div class="theme-setting">
                <h4>Gradient Theme</h4>
                <div class="theme-grid">
                  ${gradientThemes.map(theme => {
                    const isActive = state.gradientTheme === theme.name;
                    return `
                      <button 
                        class="theme-button gradient-${theme.name} ${isActive ? 'active' : ''}" 
                        onclick="setGradientTheme('${theme.name}')"
                      >
                        ${theme.displayName}
                      </button>
                    `;
                  }).join('')}
                </div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    // Master render function
    function renderApp() {
      const app = document.getElementById('app');
      let content = '';
      
      switch (state.currentView) {
        case 'inbox':
          content = renderInbox();
          break;
        case 'messages':
          content = renderMessages();
          break;
        case 'profile':
          content = renderProfile();
          break;
        default:
          content = renderInbox();
      }
      
      app.innerHTML = `
        ${content}
        ${renderBottomNav()}
        ${renderSettingsModal()}
      `;
    }

    // Make functions accessible to inline event handlers
    window.toggleTheme = toggleTheme;
    window.toggleExpand = toggleExpand;
    window.navigate = navigate;
    window.setGradientTheme = setGradientTheme;
    window.toggleSettingsModal = toggleSettingsModal;
    window.changePage = changePage;

    // Initialize the app
    loadApp();
  </script>
</body>
</html>
