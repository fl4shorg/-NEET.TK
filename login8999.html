<html class="scroll-smooth" lang="pt-BR">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   춸 洧디洧딎洧딎洧딞洧딚 洧洧딚洧딍洧딊
  </title>
  <meta content="춸 neext ltda." name="description"/>
  <link href="https://i.imgur.com/nTqoKxv.png" rel="icon" type="image/x-icon"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.160.0/three.min.js">
  </script>
  <script src="https://unpkg.com/lucide@latest">
  </script>
  <style>
   body {
      font-family: 'Inter', sans-serif;
      background-color: #0f172a;
      color: white;
      overflow-x: hidden;
      margin: 0;
      padding: 0;
    }
    /* Float animation for logo and premium badge */
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    /* Confetti styles */
    .confetti-piece {
      position: fixed;
      width: 10px;
      height: 10px;
      background-color: red;
      opacity: 0.9;
      z-index: 9999;
      pointer-events: none;
      will-change: transform, opacity;
      border-radius: 2px;
      animation-timing-function: ease-out;
    }
  </style>
 </head>
 <body class="min-h-screen flex items-center justify-center p-5 relative overflow-x-hidden">
  <!-- Background Animation Container -->
  <div class="fixed inset-0 -z-10" id="atom-bg">
  </div>
  <!-- Login Container -->
  <div class="flex flex-col md:flex-row w-full max-w-5xl rounded-xl shadow-2xl backdrop-blur-xl bg-white/10 border border-white/20 overflow-hidden min-h-[600px]" id="login-container">
   <!-- Image Side (hidden on small screens) -->
   <div class="hidden md:flex flex-1 bg-gradient-to-br from-purple-700/80 to-pink-700/80 relative border-r border-white/20 backdrop-blur-md items-center justify-center overflow-hidden">
    <div class="text-center relative z-10 px-6">
     <img alt="Logo da NEEXT LTDA, um s칤mbolo estilizado em roxo e rosa com texto abaixo" class="mx-auto mb-4 animate-[float_6s_ease-in-out_infinite]" height="120" src="https://storage.googleapis.com/a1aa/image/fa9fc55e-09ed-4b04-be37-80c10d2c8880.jpg" width="120"/>
     <h1 class="text-white font-extrabold text-3xl select-none tracking-wide">
      洧디洧딎洧딎洧딞洧딚 洧洧딚洧딍洧딊
     </h1>
     <p class="text-white/80 mt-2 font-medium select-none">
      Plataforma de Gerenciamento
     </p>
    </div>
    <img alt="Fundo abstrato em gradiente roxo e rosa com formas suaves e borradas" class="absolute inset-0 w-full h-full object-cover opacity-30" height="600" src="https://storage.googleapis.com/a1aa/image/21dbbf83-e074-4a8b-c300-29a03405d562.jpg" width="600"/>
    <div class="absolute inset-0 bg-radial-gradient from-white/10 to-transparent pointer-events-none">
    </div>
   </div>
   <!-- Form Side -->
   <div class="flex-1 p-10 md:p-16 flex flex-col relative bg-white/10 backdrop-blur-lg" id="form-side">
    <div class="absolute top-5 right-5 bg-gradient-to-br from-orange-500 to-pink-600 text-white text-xs font-semibold tracking-wide rounded-full px-4 py-1 shadow-lg animate-[float_6s_ease-in-out_infinite] select-none z-20">
     PREMIUM
    </div>
    <header class="mb-8" id="form-header">
     <h2 class="text-white text-2xl md:text-3xl font-extrabold mb-2 select-none">
      Bem-vindo(a)
     </h2>
     <p class="text-white/80 text-sm md:text-base select-none" id="form-subtitle">
      Acesse sua conta para continuar
     </p>
    </header>
    <form class="flex flex-col space-y-6" id="login-form" novalidate="">
     <!-- Usu치rio -->
     <div>
      <label class="block text-white/90 font-semibold mb-2 select-none" for="username">
       Usu치rio
      </label>
      <div class="relative">
       <span class="absolute inset-y-0 left-3 flex items-center text-white/70 pointer-events-none">
        <i class="w-5 h-5" data-lucide="user">
        </i>
       </span>
       <input autocomplete="username" class="w-full pl-10 pr-4 py-3 rounded-lg bg-white/20 text-white placeholder-white/60 border border-white/30 focus:border-purple-500 focus:ring-2 focus:ring-purple-400 outline-none transition" id="username" name="username" placeholder="Digite seu usu치rio" required="" type="text"/>
      </div>
     </div>
     <!-- Senha -->
     <div>
      <label class="block text-white/90 font-semibold mb-2 select-none" for="password">
       Senha
      </label>
      <div class="relative">
       <span class="absolute inset-y-0 left-3 flex items-center text-white/70 pointer-events-none">
        <i class="w-5 h-5" data-lucide="lock">
        </i>
       </span>
       <input autocomplete="current-password" class="w-full pl-10 pr-10 py-3 rounded-lg bg-white/20 text-white placeholder-white/60 border border-white/30 focus:border-purple-500 focus:ring-2 focus:ring-purple-400 outline-none transition" id="password" name="password" placeholder="Digite sua senha" required="" type="password"/>
       <button aria-label="Mostrar ou ocultar senha" class="absolute inset-y-0 right-3 flex items-center text-white/70 hover:text-white transition focus:outline-none" id="password-toggle" type="button">
        <i class="w-5 h-5" data-lucide="eye">
        </i>
       </button>
      </div>
     </div>
     <!-- Painel -->
     <div>
      <label class="block text-white/90 font-semibold mb-2 select-none" for="group">
       Painel
      </label>
      <div class="relative">
       <span class="absolute inset-y-0 left-3 flex items-center text-white/70 pointer-events-none">
        <i class="w-5 h-5" data-lucide="layout-dashboard">
        </i>
       </span>
       <select class="w-full pl-10 pr-10 py-3 rounded-lg bg-white/20 text-white placeholder-white/60 border border-white/30 focus:border-purple-500 focus:ring-2 focus:ring-purple-400 outline-none appearance-none transition" id="group" name="group" required="">
        <option disabled="" selected="" value="">
         Selecione seu painel
        </option>
        <option value="love">
         loveneext
        </option>
        <option value="chatarq">
         Dep칩sito chat
        </option>
        <option value="skurarq">
         Dep칩s칤to stickers
        </option>
        <option value="gartic">
         Gartic Neext
        </option>
        <option value="respostagartic">
         Gartic Respostas
        </option>
        <option value="ordersticker">
         Skur Pedidos
        </option>
        <option value="regras">
         regras da neext
        </option>
        <option value="manualskur">
         manual skur
        </option>
        <option value="manualfbi">
         manual fbi
        </option>
        <option value="cargoschat">
         cargos chat
        </option>
        <option value="cargosskur">
         cargos sticker
        </option>
        <option value="story">
         story neext
        </option>
        <option value="feedback">
         feedback neext
        </option>
        <option value="suporte">
         suporte
        </option>
        <option value="friendship">
         friendship
        </option>
        <option value="amberchat">
         amber chat
        </option>
        <option value="amberstickers">
         amber sticker
        </option>
        <option value="abinskur">
         abinskur
        </option>
        <option value="abinfbi">
         abinfbi
        </option>
        <option value="perguntas">
         perguntas neext
        </option>
        <option value="correio">
         correio neext
        </option>
        <option value="pensador">
         pensador neext
        </option>
        <option value="deten칞칚oskur">
         deten칞칚oskur
        </option>
        <option value="deten칞칚ofbi">
         deten칞칚ofbi
        </option>
        <option value="paineldiretor">
         paineldiretor
        </option>
        <option value="listanegra">
         listanegra
        </option>
        <option value="hospital">
         hospital
        </option>
        <option value="whitehouse">
         whitehouse
        </option>
        <option value="neepool">
         neepool
        </option>
        <option value="skur1">
         skur1
        </option>
        <option value="skur2">
         skur2
        </option>
        <option value="skur3">
         skur3
        </option>
        <option value="skur4">
         skur4
        </option>
        <option value="skur5">
         skur5
        </option>
        <option value="skur6">
         skur6
        </option>
        <option value="fbi1">
         fbi1
        </option>
        <option value="fbi2">
         fbi2
        </option>
        <option value="fbi3">
         fbi3
        </option>
        <option value="fbi4">
         fbi4
        </option>
        <option value="fbi5">
         fbi5
        </option>
        <option value="fbi6">
         fbi6
        </option>
        <option value="fbi7">
         fbi7
        </option>
        <option value="fbi8">
         fbi8
        </option>
        <option value="fbi9">
         fbi9
        </option>
        <option value="fbi10">
         fbi10
        </option>
       </select>
       <svg aria-hidden="true" class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-white/70" fill="none" stroke="currentColor" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round">
        </path>
       </svg>
      </div>
     </div>
     <!-- Remember Me -->
     <div class="flex items-center space-x-2 text-white/80 text-sm select-none">
      <input class="w-4 h-4 accent-purple-600 rounded" id="remember-me" type="checkbox"/>
      <label class="cursor-pointer" for="remember-me">
       Lembrar senha
      </label>
     </div>
     <!-- Submit Button -->
     <button class="w-full bg-purple-600 hover:bg-purple-700 active:bg-purple-800 transition rounded-lg py-3 text-white font-semibold flex items-center justify-center gap-3 select-none" type="submit">
      <i class="w-5 h-5" data-lucide="log-in">
      </i>
      Entrar
     </button>
    </form>
    <!-- Social Buttons -->
    <div class="mt-8 flex justify-center gap-6" id="social-buttons">
     <a aria-label="Instagram" class="w-10 h-10 rounded-full bg-gradient-to-tr from-[#f09433] via-[#e6683c] to-[#bc1888] flex items-center justify-center text-white hover:scale-110 transition" href="https://instagram.com" rel="noopener noreferrer" target="_blank">
      <i class="w-5 h-5" data-lucide="instagram">
      </i>
     </a>
     <a aria-label="WhatsApp" class="w-10 h-10 rounded-full bg-[#25D366] flex items-center justify-center text-white hover:scale-110 transition" href="https://wa.me/message/" rel="noopener noreferrer" target="_blank">
      <i class="w-5 h-5" data-lucide="message-circle">
      </i>
     </a>
    </div>
    <footer class="mt-auto pt-6 text-center text-white/50 text-xs select-none" id="form-footer">
     춸 2019 洧디洧딎洧딎洧딞洧딚 洧洧딚洧딍洧딊. Todos os direitos reservados.
    </footer>
   </div>
  </div>
  <!-- Loader -->
  <div class="fixed inset-0 bg-[#0f172a]/80 backdrop-blur-md flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-300 z-50" id="loader-container" aria-live="polite" aria-busy="false" role="alert" aria-label="Carregando">
   <div class="relative w-20 h-20">
    <div class="absolute w-full h-full border-4 border-transparent border-t-purple-500 rounded-full animate-spin">
    </div>
    <div class="absolute w-full h-full border-4 border-transparent border-r-pink-600 rounded-full animate-spin reverse">
    </div>
    <div class="absolute w-3 h-3 bg-white rounded-full top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 animate-pulse">
    </div>
   </div>
  </div>
  <!-- Toast container (dynamic) -->
  <div class="fixed top-5 right-5 max-w-xs space-y-3 z-50" id="toast-container" aria-live="polite" aria-atomic="true">
  </div>
  <!-- Post-login message container -->
  <div aria-live="polite" aria-atomic="true" class="fixed inset-0 bg-[#0f172a]/90 backdrop-blur-md flex flex-col items-center justify-center text-center px-6 py-10 text-white text-lg font-semibold space-y-6 hidden" id="post-login-message" role="alert" tabindex="-1">
   <div id="post-login-text" class="max-w-xl leading-relaxed">
   </div>
   <div aria-label="Anima칞칚o de carregamento" class="flex justify-center" id="post-login-loader" role="img" aria-busy="true" style="height: 48px; width: 48px;">
    <svg class="animate-spin h-12 w-12 text-purple-500" fill="none" viewbox="0 0 24 24" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
     <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4">
     </circle>
     <path class="opacity-75" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z" fill="currentColor">
     </path>
    </svg>
   </div>
  </div>
  <script>
   document.addEventListener('DOMContentLoaded', () => {
      lucide.createIcons();

      // Password toggle
      const passwordInput = document.getElementById('password');
      const toggleButton = document.getElementById('password-toggle');
      toggleButton.addEventListener('click', () => {
        const type = passwordInput.getAttribute('type');
        const newType = type === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', newType);
        toggleButton.innerHTML = '';
        const iconName = newType === 'text' ? 'eye-off' : 'eye';
        const iconElement = document.createElement('i');
        iconElement.setAttribute('data-lucide', iconName);
        iconElement.classList.add('w-5', 'h-5');
        toggleButton.appendChild(iconElement);
        lucide.createIcons();
      });

      // Toast function
      function showToast(message, type = 'success') {
        const toastContainer = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `flex items-center gap-3 p-4 rounded-lg shadow-lg text-white text-sm max-w-xs pointer-events-auto select-none ${
          type === 'success' ? 'bg-emerald-600 border-l-4 border-emerald-400' :
          type === 'error' ? 'bg-red-600 border-l-4 border-red-400' :
          'bg-yellow-500 border-l-4 border-yellow-400'
        }`;
        const iconName = type === 'success' ? 'check-circle' : type === 'error' ? 'alert-circle' : 'alert-triangle';
        toast.innerHTML = `<i data-lucide="${iconName}" class="w-5 h-5 flex-shrink-0"></i><span>${message}</span>`;
        toastContainer.appendChild(toast);
        lucide.createIcons();

        // Animate in
        toast.style.opacity = '0';
        toast.style.transform = 'translateY(-20px)';
        requestAnimationFrame(() => {
          toast.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
          toast.style.opacity = '1';
          toast.style.transform = 'translateY(0)';
        });

        // Auto remove after 5s
        setTimeout(() => {
          toast.style.opacity = '0';
          toast.style.transform = 'translateY(-20px)';
          toast.addEventListener('transitionend', () => toast.remove());
        }, 5000);
      }

      // Check saved credentials
      const savedUsername = localStorage.getItem('rememberedUsername');
      const savedPassword = localStorage.getItem('rememberedPassword');
      const savedGroup = localStorage.getItem('rememberedGroup');
      if (savedUsername && savedPassword && savedGroup) {
        document.getElementById('username').value = savedUsername;
        document.getElementById('password').value = savedPassword;
        document.getElementById('group').value = savedGroup;
        document.getElementById('remember-me').checked = true;
      }

      // Loader
      const loader = document.getElementById('loader-container');

      // Post-login message container and elements
      const postLoginMessage = document.getElementById('post-login-message');
      const postLoginText = document.getElementById('post-login-text');
      const postLoginLoader = document.getElementById('post-login-loader');

      // Confetti animation
      function createConfetti() {
        const colors = ['#8b5cf6', '#db2777', '#f97316', '#10b981', '#3b82f6', '#ec4899', '#facc15'];
        const confettiCount = 150;
        const confettiPieces = [];

        for (let i = 0; i < confettiCount; i++) {
          const confetti = document.createElement('div');
          confetti.classList.add('confetti-piece');
          confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.left = Math.random() * window.innerWidth + 'px';
          confetti.style.top = -10 + 'px';
          confetti.style.width = (Math.random() * 8 + 6) + 'px';
          confetti.style.height = confetti.style.width;
          confetti.style.opacity = (Math.random() * 0.6 + 0.4).toString();
          confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
          confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
          confetti.style.animationName = 'confetti-fall';
          confetti.style.animationTimingFunction = 'ease-out';
          confetti.style.animationFillMode = 'forwards';
          confetti.style.animationDelay = (Math.random() * 2) + 's';
          document.body.appendChild(confetti);
          confettiPieces.push(confetti);
        }

        // Remove confetti after animation
        setTimeout(() => {
          confettiPieces.forEach(piece => piece.remove());
        }, 7000);
      }

      // Add keyframes for confetti fall dynamically
      const styleSheet = document.createElement("style");
      styleSheet.type = "text/css";
      styleSheet.innerText = `
        @keyframes confetti-fall {
          0% {
            opacity: 1;
            transform: translateY(0) rotate(0deg);
          }
          100% {
            opacity: 0;
            transform: translateY(100vh) rotate(360deg);
          }
        }
      `;
      document.head.appendChild(styleSheet);

      // Form submission
      const form = document.getElementById('login-form');
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const username = form.username.value.trim();
        const password = form.password.value.trim();
        const group = form.group.value;
        const rememberMe = form['remember-me'].checked;

        if (!username || !password || !group) {
          showToast("Por favor, preencha todos os campos!", "warning");
          return;
        }

        if (rememberMe) {
          localStorage.setItem('rememberedUsername', username);
          localStorage.setItem('rememberedPassword', password);
          localStorage.setItem('rememberedGroup', group);
        } else {
          localStorage.removeItem('rememberedUsername');
          localStorage.removeItem('rememberedPassword');
          localStorage.removeItem('rememberedGroup');
        }

        try {
          // Show loader
          loader.classList.remove('pointer-events-none');
          loader.classList.add('opacity-100');
          loader.classList.remove('opacity-0');

          const response = await fetch(
            `https://script.google.com/macros/s/AKfycbwDUfyWsGqSJ8Q9przj7LHxw7zxuvLYd7UfgiCP4F3Fju9i7kB-LtRReQMjpDDw5-Q/exec?action=login&username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&group=${encodeURIComponent(group)}`
          );

          if (!response.ok) throw new Error("Erro ao conectar com o servidor.");

          const result = await response.text();
          const decodedResult = decodeURIComponent(result);

          // Hide loader
          loader.classList.add('opacity-0');
          loader.classList.remove('opacity-100');
          loader.classList.add('pointer-events-none');

          if (decodedResult.startsWith("http")) {
            // Hide form and social buttons
            document.getElementById('login-container').classList.add('opacity-0', 'pointer-events-none');
            // Show post-login message container
            postLoginMessage.classList.remove('hidden');
            postLoginMessage.focus();

            // Sequence of messages and animations
            const messages = [
              `Ol치, ${username}! Aguarde um momento, estou verificando seu dispositivo...`,
              `Verificando seu acesso em nosso servidor remoto...`,
              `Desculpa pela demora, estamos com prote칞칚o mais refor칞ada no login...`
            ];

            let index = 0;

            function showNextMessage() {
              if (index < messages.length) {
                postLoginText.textContent = messages[index];
                postLoginLoader.style.display = 'flex';
                index++;
                setTimeout(() => {
                  postLoginLoader.style.display = 'none';
                  setTimeout(showNextMessage, 1500);
                }, 3500);
              } else {
                // Show final message with confetti
                postLoginText.textContent = 'Redirecionando voc칡 para seu painel...';
                postLoginLoader.style.display = 'none';
                createConfetti();
                setTimeout(() => {
                  window.location.href = decodedResult;
                }, 4000);
              }
            }
            showNextMessage();
          } else {
            showToast(decodedResult, "error");
          }
        } catch (error) {
          loader.classList.add('pointer-events-none');
          loader.classList.remove('opacity-100');
          loader.classList.add('opacity-0');
          showToast('Ocorreu um erro ao fazer login. Tente novamente.', "error");
          console.error(error);
        }
      });

      // Initialize 3D atom background
      (function initAtomBackground() {
        const container = document.getElementById('atom-bg');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 30;
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x000000, 0);
        container.appendChild(renderer.domElement);

        const particlesCount = 300;
        const particles = new THREE.Group();
        scene.add(particles);

        const particleGeometries = [
          new THREE.SphereGeometry(0.2, 16, 16),
          new THREE.SphereGeometry(0.3, 16, 16),
          new THREE.SphereGeometry(0.15, 12, 12),
        ];

        const particleColors = [
          0x8B5CF6,
          0xD946EF,
          0x2563EB,
          0x3B82F6,
          0x10B981,
        ];

        const particleMaterials = particleColors.map(color =>
          new THREE.MeshBasicMaterial({
            color: color,
            transparent: true,
            opacity: 0.7,
          })
        );

        for (let i = 0; i < particlesCount; i++) {
          const geometry = particleGeometries[Math.floor(Math.random() * particleGeometries.length)];
          const material = particleMaterials[Math.floor(Math.random() * particleMaterials.length)];
          const particle = new THREE.Mesh(geometry, material);
          particle.position.x = (Math.random() - 0.5) * 90;
          particle.position.y = (Math.random() - 0.5) * 90;
          particle.position.z = (Math.random() - 0.5) * 90;
          particle.userData = {
            speed: Math.random() * 0.2,
            rotationSpeed: Math.random() * 0.03,
            orbitRadius: Math.random() * 3 + 0.5,
            orbitOffset: Math.random() * Math.PI * 2,
            pulseSpeed: Math.random() * 0.01,
            originalScale: 0.8 + Math.random() * 0.4,
            cellType: Math.random() > 0.7 ? 'cell' : 'atom',
          };
          particle.scale.set(particle.userData.originalScale, particle.userData.originalScale, particle.userData.originalScale);
          particles.add(particle);
        }

        const nucleusCount = 10;
        const nuclei = [];
        for (let i = 0; i < nucleusCount; i++) {
          const position = new THREE.Vector3(
            (Math.random() - 0.5) * 60,
            (Math.random() - 0.5) * 60,
            (Math.random() - 0.5) * 60
          );
          const nucleus = {
            position: position,
            radius: 8 + Math.random() * 5,
            rotationAxis: new THREE.Vector3(
              Math.random() - 0.5,
              Math.random() - 0.5,
              Math.random() - 0.5
            ).normalize(),
            rotationSpeed: 0.001 + Math.random() * 0.002
          };
          nuclei.push(nucleus);
        }

        const lineMaterial = new THREE.LineBasicMaterial({
          color: 0xD946EF,
          transparent: true,
          opacity: 0.2,
        });
        const blueLineMaterial = new THREE.LineBasicMaterial({
          color: 0x3B82F6,
          transparent: true,
          opacity: 0.2,
        });
        const connections = [];

        const createConnections = () => {
          connections.forEach(line => scene.remove(line));
          connections.length = 0;
          for (let i = 0; i < particles.children.length; i++) {
            const particleA = particles.children[i];
            for (let j = i + 1; j < particles.children.length; j++) {
              const particleB = particles.children[j];
              const distance = particleA.position.distanceTo(particleB.position);
              if (distance < 8 + Math.random() * 4) {
                const geometry = new THREE.BufferGeometry().setFromPoints([particleA.position, particleB.position]);
                const material = Math.random() > 0.5 ? lineMaterial : blueLineMaterial;
                const line = new THREE.Line(geometry, material);
                scene.add(line);
                connections.push(line);
              }
            }
          }
        };

        const orbitalRings = [];
        nuclei.slice(0, 5).forEach(nucleus => {
          const ringGeometry = new THREE.TorusGeometry(nucleus.radius, 0.05, 16, 100);
          const ringMaterial = new THREE.MeshBasicMaterial({
            color: 0x8B5CF6,
            transparent: true,
            opacity: 0.3
          });
          const ringCount = Math.floor(Math.random() * 3) + 1;
          for (let i = 0; i < ringCount; i++) {
            const ring = new THREE.Mesh(ringGeometry, ringMaterial);
            ring.position.copy(nucleus.position);
            ring.rotation.x = Math.random() * Math.PI;
            ring.rotation.y = Math.random() * Math.PI;
            scene.add(ring);
            ring.userData = {
              rotationAxis: new THREE.Vector3(
                Math.random() - 0.5,
                Math.random() - 0.5,
                Math.random() - 0.5
              ).normalize(),
              rotationSpeed: 0.003 + Math.random() * 0.005
            };
            orbitalRings.push(ring);
          }
        });

        const handleResize = () => {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
        };
        window.addEventListener('resize', handleResize);

        const calculateNucleusInfluence = (particle) => {
          let influenceX = 0, influenceY = 0, influenceZ = 0;
          nuclei.forEach(nucleus => {
            const distance = particle.position.distanceTo(nucleus.position);
            if (distance < nucleus.radius * 2) {
              const force = 0.02 * (nucleus.radius / (distance + 1));
              const dirX = (nucleus.position.x - particle.position.x);
              const dirY = (nucleus.position.y - particle.position.y);
              const dirZ = (nucleus.position.z - particle.position.z);
              const orbitFactor = 0.003;
              influenceX += dirY * orbitFactor - dirX * force;
              influenceY += -dirX * orbitFactor - dirY * force;
              influenceZ += dirZ * orbitFactor - dirZ * force;
            }
          });
          return { influenceX, influenceY, influenceZ };
        };

        let frameCount = 0;
        const animate = () => {
          requestAnimationFrame(animate);
          frameCount++;
          particles.rotation.x += 0.0003;
          particles.rotation.y += 0.0005;
          const time = Date.now() * 0.001;

          particles.children.forEach(particle => {
            const { speed, rotationSpeed, orbitOffset, pulseSpeed, originalScale, cellType } = particle.userData;
            const { influenceX, influenceY, influenceZ } = calculateNucleusInfluence(particle);
            const particleTime = time * speed;

            if (cellType === 'cell') {
              particle.position.x += Math.sin(particleTime + orbitOffset) * 0.01 + influenceX;
              particle.position.y += Math.cos(particleTime + orbitOffset) * 0.01 + influenceY;
              particle.position.z += Math.sin(particleTime * 0.7) * 0.01 + influenceZ;
            } else {
              particle.position.x += Math.sin(particleTime + orbitOffset) * 0.02 + influenceX;
              particle.position.y += Math.cos(particleTime + orbitOffset) * 0.02 + influenceY;
              particle.position.z += Math.sin(particleTime * 1.3) * 0.02 + influenceZ;
            }

            const pulse = Math.sin(time * pulseSpeed * 5) * 0.1 + 1;
            particle.scale.set(originalScale * pulse, originalScale * pulse, originalScale * pulse);
            particle.rotation.x += rotationSpeed;
            particle.rotation.y += rotationSpeed * 0.8;
          });

          orbitalRings.forEach(ring => {
            const { rotationAxis, rotationSpeed } = ring.userData;
            ring.rotateOnAxis(rotationAxis, rotationSpeed);
          });

          if (frameCount % 30 === 0) createConnections();

          if (frameCount % 120 === 0) {
            particles.children.forEach(particle => {
              const distance = particle.position.length();
              if (distance > 100) particle.position.multiplyScalar(0.5);
            });
          }

          renderer.render(scene, camera);
        };
        animate();
      })();
    });
  </script>
 </body>
</html>